<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>City Nature Challenge, Los Angeles: Coding Workshop: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="assets/styles.css">
<script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="manifest" href="site.webmanifest">
<link rel="mask-icon" href="safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav incubator"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="Carpentries Incubator" src="assets/images/incubator-logo.svg"><abbr class="badge badge-light" title="This lesson is in the alpha phase, which means that it has been taught once and lesson authors are iterating on feedback." style="background-color: #FFC700; border-radius: 5px">
          <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#field-testing-alpha-stage" class="external-link alert-link" style="color: #383838">
            <i aria-hidden="true" class="icon" data-feather="alert-triangle" style="border-radius: 5px"></i>
            Alpha
          </a>
          <span class="visually-hidden">This lesson is in the alpha phase, which means that it has been taught once and lesson authors are iterating on feedback.</span>
        </abbr>
        
      </div>
    </div>
    <div class="selector-container">
      
      
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/aio.html';">Instructor View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Carpentries Incubator" src="assets/images/incubator-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      City Nature Challenge, Los Angeles: Coding Workshop
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            City Nature Challenge, Los Angeles: Coding Workshop
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
<li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul>
</li>
      </ul>
</div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a class="btn btn-primary" href="aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  City Nature Challenge, Los Angeles: Coding Workshop
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/aio.html">Instructor View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->
      
            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="1_intro_data_analysis.html">1. Intro to Data Analysis</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="2_introduction-r-rstudio.html">2. Introduction to R and RStudio</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="3_how-r-thinks-about-data.html">3. Exploring and understanding data</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="4_working_with_data.html">4. Working with data</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="5_visualizing-ggplot.html">5. Data visualization with ggplot2</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="6_creating_maps.html">6. Creating maps</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="reference.html">Reference</a></li>
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width resources">
<a href="aio.html">See all in one page</a>
            

            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">
            
            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-1_intro_data_analysis"><p>Content from <a href="1_intro_data_analysis.html">Intro to Data Analysis</a></p>
<hr>
<p>Last updated on 2024-05-24 |
        
        <a href="https://github.com/wykhuh/CNC-coding-workshop/edit/main/episodes/1_intro_data_analysis.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do we begin to analyze iNaturalist data?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Learn how to download data from iNaturalist</li>
<li>Learn about the various ways to analyze data</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="section level1">
<h1 id="inaturalist-data">iNaturalist data<a class="anchor" aria-label="anchor" href="#inaturalist-data"></a>
</h1>
<p>When iNaturalist users add an observation through the iNaturalist
app, that data is saved to the iNaturalist database. People can download
the iNaturalist data as CSVs.</p>
<p>CSV is a text file format for tabular data. Each line represents one
record. Each column represents a field. The fields are separated by
commas.</p>
<p>The iNaturalist CSV has information about:</p>
<ul>
<li>the user who made observation</li>
<li>the location of the observation</li>
<li>the observed species</li>
<li>links for photos, videos, sounds</li>
</ul>
</div>
<div class="section level1">
<h1 id="instructions-to-download-inaturalist-data">Instructions to download iNaturalist data<a class="anchor" aria-label="anchor" href="#instructions-to-download-inaturalist-data"></a>
</h1>
<p>Here’s a video that shows how to select and download data from
iNaturalist.</p>
<p>To save time and ensure everyone at the workshop has the same data,
here is a link to a CSV with iNaturalist City Nature Challenge Los
Angeles data from 2013 to 2024.</p>
<p>More info about downloading iNaturalist observation data.</p>
<p><a href="https://help.inaturalist.org/en/support/solutions/articles/151000169670" class="external-link uri">https://help.inaturalist.org/en/support/solutions/articles/151000169670</a></p>
<p><a href="https://help.inaturalist.org/en/support/solutions/articles/151000170342-how-can-i-download-data-from-inaturalist-" class="external-link uri">https://help.inaturalist.org/en/support/solutions/articles/151000170342-how-can-i-download-data-from-inaturalist-</a></p>
</div>
<div class="section level1">
<h1 id="analyzing-data">Analyzing data<a class="anchor" aria-label="anchor" href="#analyzing-data"></a>
</h1>
<p>It is difficult for people to see any patterns when reading rows
after row of text. To make it easier to see patterns, we can use
software to analyze tabular data.</p>
<ol style="list-style-type: decimal">
<li><p>Spreadsheet programs are computer application that people can use
to view, edit, and analyze tabular data. The programs can do
calculations and create charts. Examples include Excel and Google
Sheets</p></li>
<li><p>Geographic information system (GIS) are computer application that
people can use to view, edit and analyze geographic data. The programs
can do calculations and create maps. Examples include ArcGIS and
QGIS.</p></li>
<li><p>Programming languages allow people to write instructions to tell
a computer to do stuff. We write these instructions in the form of code.
We can write code to do calculations, create charts, and create maps.
Example programming languages include R, Python, C.</p></li>
</ol>
<p>This class uses R because it is a popular language in ecology
research and other types of scientific research.</p>
</div>
<div class="section level1">
<h1 id="example-of-analyzing-inaturalist-data-using-r">Example of analyzing iNaturalist data using R<a class="anchor" aria-label="anchor" href="#example-of-analyzing-inaturalist-data-using-r"></a>
</h1>
<p>Load software that will will need.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">readr</span><span class="op">)</span> <span class="co"># read and write tabular data</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">dplyr</span><span class="op">)</span> <span class="co"># manipulate data</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">ggplot2</span><span class="op">)</span> <span class="co"># create data visualizations</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">sf</span><span class="op">)</span> <span class="co"># geospatial</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">lubridate</span><span class="op">)</span> <span class="co"># manipulate dates</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">mapview</span><span class="op">)</span> <span class="co"># create interactive maps</span></span></code></pre>
</div>
<p>Load iNaturalist data from City Nature Challenge Los Angeles
2013-2023. There are over 170,000 observations.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inat</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"data/raw/observations-397280.csv"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Rows: 171155 Columns: 39
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (23): observed_on_string, time_observed_at, time_zone, user_login, user...
dbl  (10): id, user_id, num_identification_agreements, num_identification_di...
lgl   (5): captive_cultivated, private_place_guess, private_latitude, privat...
date  (1): observed_on

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<p>Get the 10 most commonly observed ‘species’.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">top_10</span> <span class="op">&lt;-</span> <span class="va">inat</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="op">!</span><span class="fu">is.na</span><span class="op">(</span><span class="va">scientific_name</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">common_name</span>, <span class="va">scientific_name</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">common_name</span>, <span class="va">scientific_name</span>, name<span class="op">=</span><span class="st">'count'</span><span class="op">)</span>  <span class="op">%&gt;%</span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">slice</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">top_10</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 10 × 3
   common_name            scientific_name         count
   &lt;chr&gt;                  &lt;chr&gt;                   &lt;int&gt;
 1 Western Fence Lizard   Sceloporus occidentalis  2970
 2 dicots                 Magnoliopsida            1978
 3 Western Honey Bee      Apis mellifera           1818
 4 plants                 Plantae                  1665
 5 Fox Squirrel           Sciurus niger            1323
 6 flowering plants       Angiospermae             1151
 7 House Finch            Haemorhous mexicanus     1122
 8 Mourning Dove          Zenaida macroura         1078
 9 Convergent Lady Beetle Hippodamia convergens     840
10 House Sparrow          Passer domesticus         838</code></pre>
</div>
<p>Create a bar chart showing the number of observations per year.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inat</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>year <span class="op">=</span> <span class="fu">year</span><span class="op">(</span><span class="va">observed_on</span><span class="op">)</span><span class="op">)</span>  <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">year</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/1_intro_data_analysis-rendered-unnamed-chunk-5-1.png" width="600" height="600" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Create a map showing all the observations for Western Fence
Lizard</p>
<p><a href="https://www.ecologi.st/spatial-r/rdemo.html#converting-a-dataframe-into-a-spatial-object" class="external-link uri">https://www.ecologi.st/spatial-r/rdemo.html#converting-a-dataframe-into-a-spatial-object</a></p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inat_lizard</span> <span class="op">&lt;-</span> <span class="va">inat</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="op">!</span><span class="fu">is.na</span><span class="op">(</span><span class="va">latitude</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>           <span class="op">!</span><span class="fu">is.na</span><span class="op">(</span><span class="va">longitude</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>           <span class="op">!</span><span class="fu">is.na</span><span class="op">(</span><span class="va">scientific_name</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">st_as_sf</span><span class="op">(</span>coords <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"longitude"</span>, <span class="st">"latitude"</span><span class="op">)</span>,   crs <span class="op">=</span> <span class="fl">4326</span>, remove<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">id</span>, <span class="va">user_login</span>, <span class="va">common_name</span>, <span class="va">scientific_name</span>, <span class="va">observed_on</span>,  <span class="va">url</span>, <span class="va">longitude</span>, <span class="va">latitude</span>, <span class="va">geometry</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">common_name</span> <span class="op">==</span> <span class="st">'Western Fence Lizard'</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu">mapview</span><span class="op">(</span><span class="va">inat_lizard</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/1_intro_data_analysis-rendered-unnamed-chunk-6-1.png" width="600" height="600" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</div></section><section id="aio-2_introduction-r-rstudio"><p>Content from <a href="2_introduction-r-rstudio.html">Introduction to R and RStudio</a></p>
<hr>
<p>Last updated on 2024-05-24 |
        
        <a href="https://github.com/wykhuh/CNC-coding-workshop/edit/main/episodes/2_introduction-r-rstudio.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>Why should you use R and RStudio?</li>
<li>How do you get started working in R and RStudio?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand the difference between R and RStudio</li>
<li>Describe the purpose of the different RStudio panes</li>
<li>Organize files and directories into R Projects</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="what-are-r-and-rstudio"><h2 class="section-heading">What are R and RStudio?<a class="anchor" aria-label="anchor" href="#what-are-r-and-rstudio"></a>
</h2>
<hr class="half-width">
<p>R refers to a programming language as well as the software that runs
R code.</p>
<p><a href="https://rstudio.com" class="external-link">RStudio</a> is a software application
that can make it easier to write and run code in R.</p>
<p>Think of R as English, and RStudio as Microsoft Word or Google
Docs.</p>
<p>Both R and RStudio are: - free - cross platform: works on Mac,
Windows, Linux - open source: allows anyone to use and modify the
software</p>
</section><section id="navigating-rstudio"><h2 class="section-heading">Navigating RStudio<a class="anchor" aria-label="anchor" href="#navigating-rstudio"></a>
</h2>
<hr class="half-width">
<p>RStudio puts most of the things you need to work in R into a single
window, and also includes features like keyboard shortcuts,
autocompletion of code, and syntax highlighting (different types of code
are colored differently, making it easier to navigate your code).</p>
<figure><img src="fig/rstudio_screenshot.png" alt='Screenshot of RStudio showing the 4 "panes".' class="figure mx-auto d-block"></figure><p>In the above screenshot, we can see 4 “panes” in the default
layout:</p>
<ul>
<li>Top-Left: the <strong>Source</strong> pane that displays scripts and
other files. You will write code into scripts and run code.
<ul>
<li>If you only have 3 panes, and the Console pane is in the top left,
press <kbd>Shift+Cmd+N</kbd> (Mac) or <kbd>Shift+Ctrl+N</kbd> (Windows)
to open a blank R script, which should make the Source pane appear.</li>
</ul>
</li>
<li>Top-Right: the <strong>Environment/History</strong> pane, which
shows all the objects in your current R session (Environment) and your
command history (History)</li>
<li>Bottom-Left: the <strong>Console</strong> pane, where you can
interact directly with an R console, which interprets R commands and
prints the results</li>
<li>Bottom-Right: the <strong>Files/Plots/Help/Viewer</strong> pane to
navigate files on our computer, view plots and view help pages</li>
</ul></section><div class="section level1">
<h1 id="getting-set-up-in-rstudio">Getting set up in RStudio<a class="anchor" aria-label="anchor" href="#getting-set-up-in-rstudio"></a>
</h1>
<p>RStudio provides a “Projects” feature that can make it easier to work
on individual projects in R. We will create a project that we will keep
everything for this workshop.</p>
<ol style="list-style-type: decimal">
<li>Start RStudio (you should see a view similar to the screenshot
above).</li>
<li>In the top right, you will see a blue 3D cube and the words
“Project: (None)”. Click on this icon.</li>
<li>Click New Project from the dropdown menu.</li>
<li>Click New Directory, then New Project.</li>
<li>Type out a name for the project.</li>
<li>Put it in a convenient location using the “Create project as a
subdirectory of:” section. You can always move the project somewhere
else later, because it will be self-contained.</li>
<li>Click Create Project and your new project will open.</li>
</ol>
<p>When you need to work on the project, click on the Rproj icon to
start RStudio.</p>
<p>One of the benefits to using RStudio Projects is that they
automatically set the working directory to the top-level folder for the
project. The working directory is the folder where R is working, so it
views the location of all files (including data and scripts) as being
relative to the working directory.</p>
<div class="section level2">
<h2 id="organizing-your-project-directory">Organizing your project directory<a class="anchor" aria-label="anchor" href="#organizing-your-project-directory"></a>
</h2>
<p>Using a consistent folder structure across all your new projects will
help keep a growing project organized, and make it easy to find files in
the future.</p>
<p>We will use a basic structure for this workshop.</p>
<pre><code>project_folder
│
└── scripts
│
└── data
│    └── cleaned
│    └── raw
│
└─── images
│
└─── documents</code></pre>
<p>Within our project folder, we first have a <code>scripts</code>
folder to hold any scripts we write. We also have a <code>data</code>
folder containing <code>cleaned</code> and <code>raw</code> subfolders.
In general, you want to keep your <code>raw</code> data completely
untouched, so once you put data into that folder, you do not modify it.
Instead, you read it into R, and if you make any modifications, you
write that modified file into the <code>cleaned</code> folder. We also
have an <code>images</code> folder for plots we make, and a
<code>documents</code> folder for any other documents you might
produce.</p>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</div>
</div></section><section id="aio-3_how-r-thinks-about-data"><p>Content from <a href="3_how-r-thinks-about-data.html">Exploring and understanding data</a></p>
<hr>
<p>Last updated on 2024-05-24 |
        
        <a href="https://github.com/wykhuh/CNC-coding-workshop/edit/main/episodes/3_how-r-thinks-about-data.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How does R store and represent data?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Solve simple arithmetic operations in R.</li>
<li>Use comments to inform script.</li>
<li>Assign values to objects in R.</li>
<li>Call functions and use arguments to change their default
options.</li>
<li>Understand vector types and missing data</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="setup"><h2 class="section-heading">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<hr class="half-width"></section><section id="simple-arithmetic-operations"><h2 class="section-heading">Simple arithmetic operations<a class="anchor" aria-label="anchor" href="#simple-arithmetic-operations"></a>
</h2>
<hr class="half-width">
<p>You can use R to do simple calculations</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">3</span> <span class="op">*</span> <span class="fl">5</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 15</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">3</span> <span class="op">+</span> <span class="fl">5</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 8</code></pre>
</div>
<p>The results will be shown in the console.</p>
</section><section id="comments"><h2 class="section-heading">Comments<a class="anchor" aria-label="anchor" href="#comments"></a>
</h2>
<hr class="half-width">
<p>All programming languages allow the programmer to include comments in
their code to explain the code.</p>
<p>To do this in R we use the <code>#</code> character. Anything to the
right of the <code>#</code> sign and up to the end of the line is
treated as a comment and is ignored by R. You can start lines with
comments or include them after any code on the line.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">3</span> <span class="op">*</span> <span class="fl">5</span>  <span class="co"># my first comment </span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 15</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># my second comment</span></span></code></pre>
</div>
<p>RStudio makes it easy to comment or uncomment a paragraph: after
selecting the lines you want to comment, press at the same time on your
keyboard <kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>C</kbd>. If you only
want to comment out one line, you can put the cursor at any location of
that line (i.e. no need to select the whole line), then press
<kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>C</kbd>.</p>
</section><section id="creating-objects-in-r"><h2 class="section-heading">Creating objects in R<a class="anchor" aria-label="anchor" href="#creating-objects-in-r"></a>
</h2>
<hr class="half-width">
<p>A fundemental part of programming is assigning values to named
objects. The value is stored in memory, and we can refer to value using
the name of the object. To create an object, we need to give it a name
followed by the assignment operator <code>&lt;-</code>, and the value we
want to give it.</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rectangle_length</span> <span class="op">&lt;-</span> <span class="fl">3</span></span></code></pre>
</div>
<p>What we are doing here is taking the result of the code on the right
side of the arrow, and assigning it to an object whose name is on the
left side of the arrow. So, after executing
<code>rectangle_length &lt;- 3</code>, the value of
<code>rectangle_length</code> is <code>3</code>.</p>
<p>In RStudio, typing <kbd>Alt</kbd> + <kbd>-</kbd> (push <kbd>Alt</kbd>
at the same time as the <kbd>-</kbd> key) will write <code>&lt;-</code>
in a single keystroke in a PC, while typing <kbd>Option</kbd> +
<kbd>-</kbd> (push <kbd>Option</kbd> at the same time as the
<kbd>-</kbd> key) does the same in a Mac.</p>
<p>Objects are displayed in Environment panel. Objects are stored in R
memory, and can be accessed by typing the name of the object. If you
restart R or RStudio, all the objects are deleted from memory.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rectangle_length</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 3</code></pre>
</div>
<p>Let’s create second object.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rectangle_width</span> <span class="op">&lt;-</span> <span class="fl">5</span></span></code></pre>
</div>
<p>Now that R has <code>rectangle_length</code> and
<code>rectangle_width</code> in memory, we can do arithmetic with
it.</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rectangle_length</span> <span class="op">*</span> <span class="va">rectangle_width</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 15</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rectangle_length</span> <span class="op">+</span> <span class="va">rectangle_width</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 8</code></pre>
</div>
<p>We can also store the results in an object.</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rectangle_area</span> <span class="op">&lt;-</span> <span class="va">rectangle_length</span> <span class="op">*</span> <span class="va">rectangle_width</span></span></code></pre>
</div>
<p>When assigning a value to an object, R does not print anything. You
can force R to print the value by typing the object name:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rectangle_area</span> <span class="op">&lt;-</span> <span class="va">rectangle_length</span> <span class="op">*</span> <span class="va">rectangle_width</span>    <span class="co"># doesn't print anything</span></span>
<span><span class="va">rectangle_area</span>        <span class="co"># typing the name of the object prints the value of the object</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 15</code></pre>
</div>
<p>We can also change an object’s value by assigning it a new one:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rectangle_length</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">rectangle_length</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 4</code></pre>
</div>
<p>You will be naming a of objects in R, and there are a few common
naming rules and conventions:</p>
<ul>
<li>make names clear without being too long</li>
<li>names cannot start with a number</li>
<li>names are case sensitive. rectangle_length is different than
Rectangle_length.</li>
<li>you cannot use the names of fundamental functions in R, like
<code>if</code>, <code>else</code>, or <code>for</code>
</li>
<li>avoid dots <code>.</code> in names</li>
<li>two common formats are <code>snake_case</code> and
<code>camelCase</code>
</li>
<li>be consistent, at least within a script, ideally within a whole
project</li>
</ul></section><section id="functions"><h2 class="section-heading">Functions<a class="anchor" aria-label="anchor" href="#functions"></a>
</h2>
<hr class="half-width">
<p>Functions are lines of code that are grouped together to do
something. R language has many built in functions. You can also install
and import R packages which have functions and data written by other
people. You can also create your own function.</p>
<p>A function usually gets one or more inputs called <em>arguments</em>.
Functions will do something with the arguments. Functions often (but not
always) return a <em>value</em>. Executing a function (‘running it’) is
called <em>calling</em> the function.</p>
<p>R has a function <code>round()</code>, that will round a number to a
certain number of decimal places. We pass in <code>3.14159</code>, and
it has returned the value <code>3</code>. That’s because the default is
to round to the nearest whole number.</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">round</span><span class="op">(</span><span class="fl">3.14159</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 3</code></pre>
</div>
<p>To learn more about a function, you can type a <code>?</code> in
front of the name of the function, which will bring up the official
documentation for that function:</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="va">round</span></span></code></pre>
</div>
<p>Function documentation is written by the authors of the functions, so
they can vary pretty widely in their style and readability.
<strong>Description</strong> section gives you a description of what the
function does. <strong>Arguments</strong> section defines all the
arguments for the function and is usually worth reading thoroughly.
<strong>Examples</strong> section at the end will often have some
helpful examples that you can run to get a sense of what the function is
doing.</p>
<p><code>args()</code> will show the arguments of a function.</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">args</span><span class="op">(</span><span class="va">round</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="kw">function</span> <span class="op">(</span><span class="va">x</span>, <span class="va">digits</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> </span>
<span><span class="cn">NULL</span></span></code></pre>
</div>
<p><code>round()</code> takes two arguements: x and digits. If we want a
different number of digits, we can type <code>digits=2</code>.</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">round</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">3.14159</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 3.14</code></pre>
</div>
<p>If you provide the arguments in the exact same order as they are
defined you don’t have to name them:</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">round</span><span class="op">(</span><span class="fl">3.14159</span>, <span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 3.14</code></pre>
</div>
<p>And if you do name the arguments, you can switch their order:</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">round</span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span>, x <span class="op">=</span> <span class="fl">3.14159</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 3.14</code></pre>
</div>
</section><section id="data-types-in-r"><h2 class="section-heading">Data types in R<a class="anchor" aria-label="anchor" href="#data-types-in-r"></a>
</h2>
<hr class="half-width">
<p>Objects can store different types of values such as numbers, letters,
etc. These different types of data are called data types.</p>
<p>The function <code>typeof()</code> indicates the type of an
object.</p>
<p>The 3 common data types we will use in this class:</p>
<ol style="list-style-type: decimal">
<li>numeric, aka double - all numbers with and without decimals.</li>
</ol>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_number</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="fu">typeof</span><span class="op">(</span><span class="va">my_number</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "double"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_number_2</span> <span class="op">&lt;-</span> <span class="fl">2.2</span></span>
<span><span class="fu">typeof</span><span class="op">(</span><span class="va">my_number_2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "double"</code></pre>
</div>
<ol start="2" style="list-style-type: decimal">
<li>character - all characters. The characters must be wrapped in quotes
(“” or ’’).</li>
</ol>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_character</span> <span class="op">&lt;-</span> <span class="st">'dog'</span></span>
<span><span class="fu">typeof</span><span class="op">(</span><span class="va">my_character</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "character"</code></pre>
</div>
<ol start="3" style="list-style-type: decimal">
<li>logical - can only have two values: TRUE and FALSE. Must be
capitialize.</li>
</ol>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_logical</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span><span class="fu">typeof</span><span class="op">(</span><span class="va">my_logical</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "logical"</code></pre>
</div>
</section><section id="vectors"><h2 class="section-heading">Vectors<a class="anchor" aria-label="anchor" href="#vectors"></a>
</h2>
<hr class="half-width">
<p>A vector is a collection of values. We can assign a series of values
to a vector using the <code>c()</code> function. All values in a vector
must be the same data type.</p>
<p>Create an numeric vector.</p>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_numbers</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">my_numbers</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1 2 5</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">typeof</span><span class="op">(</span><span class="va">my_numbers</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "double"</code></pre>
</div>
<p>Create an character vector.</p>
<div class="codewrapper sourceCode" id="cb44">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_words</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">'the'</span>, <span class="st">'dog'</span><span class="op">)</span></span>
<span><span class="va">my_words</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "the" "dog"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb46">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">typeof</span><span class="op">(</span><span class="va">my_words</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "character"</code></pre>
</div>
<p>If you try to create a vector with multiple types, R will coerce all
the values to the same type.</p>
<p>When there are numbers and charcters in a vector, all values are
coerced to string.</p>
<div class="codewrapper sourceCode" id="cb48">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mixed</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="st">'three'</span><span class="op">)</span></span>
<span><span class="va">mixed</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "1"     "2"     "three"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb50">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">typeof</span><span class="op">(</span><span class="va">mixed</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "character"</code></pre>
</div>
</section><section id="missing-data"><h2 class="section-heading">Missing data<a class="anchor" aria-label="anchor" href="#missing-data"></a>
</h2>
<hr class="half-width">
<p>When dealing with data, there are times when a record does not have a
value for a field. Imagine filling out a form, and leaving some of the
fields blank. R represents missing data as <code>NA</code>, without
quotes. Let’s make a numeric vector with an <code>NA</code> value:</p>
<div class="codewrapper sourceCode" id="cb52">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ages</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">25</span>, <span class="fl">34</span>, <span class="cn">NA</span>, <span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">ages</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 25 34 NA 42</code></pre>
</div>
<p><code>min()</code> returns the minimum value in a vector. If we pass
vector with NA a numeric function like <code>min()</code>, R won’t know
what to do, so it returns <code>NA</code>:</p>
<div class="codewrapper sourceCode" id="cb54">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">min</span><span class="op">(</span><span class="va">ages</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] NA</code></pre>
</div>
<p>Many basic math functions use <code>na.rm</code> argument to remove
NA values from the vector when doing the calculation.</p>
<div class="codewrapper sourceCode" id="cb56">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">min</span><span class="op">(</span><span class="va">ages</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 25</code></pre>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section><section id="aio-4_working_with_data"><p>Content from <a href="4_working_with_data.html">Working with data</a></p>
<hr>
<p>Last updated on 2024-05-24 |
        
        <a href="https://github.com/wykhuh/CNC-coding-workshop/edit/main/episodes/4_working_with_data.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do you manipulate tabular data in R?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Import CSV data into R.</li>
<li>Use pipes to link steps together into pipelines.</li>
<li>Export data to a CSV file.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="r-packages"><h2 class="section-heading">R Packages<a class="anchor" aria-label="anchor" href="#r-packages"></a>
</h2>
<hr class="half-width">
<p>R packages are extensions to the R language. R packages contain code,
data, and documentation that people can download and install to add more
functionality to R.</p>
<p>To download and install packages onto your computer, type
<code>install.packages("package_name")</code> in the R console. Must use
quotes. This function will connect to the internet and download packages
from servers that have R packages. The Comprehensive R Archive Network
(cran.r-project.org) is a network of web servers around the world that
store R packages.</p>
<p>To use the package, use <code>library(package_name)</code> to load
it. Do not use quotes. You want to install the package to your computer
once, and then load it with <code>library()</code> in each script where
you need to use it. Generally its a good idea to list all the libraries
at the beginning of the script.</p>
<div class="section level3">
<h3 id="tidyverse">
<code>tidyverse</code><a class="anchor" aria-label="anchor" href="#tidyverse"></a>
</h3>
<p><code>tidyverse</code> is collection of R packages that are used for
analyzing data. These packages like data in “tidy” format, which means
each column represents a single field, and each row represents a single
record</p>
</div>
</section><section id="importing-data"><h2 class="section-heading">Importing data<a class="anchor" aria-label="anchor" href="#importing-data"></a>
</h2>
<hr class="half-width">
<div class="section level4">
<h4 id="file-paths">File paths<a class="anchor" aria-label="anchor" href="#file-paths"></a>
</h4>
<p>When we reference other files from an R script, we need to give R
precise instructions on where those files are. We do that using
something called a <strong>file path</strong>.</p>
<p>There are two kinds of paths: <strong>absolute</strong> and
<strong>relative</strong>. Absolute paths are specific to a particular
computer, whereas relative paths are relative to a certain folder. For
instance an absolute path is
“/Users/wyk/Documents/code_stuff/CNC_coding_intro_lesson”, and relative
path is “CNC_coding_intro_lesson”.</p>
</div>
<div class="section level4">
<h4 id="read-a-file">Read a file<a class="anchor" aria-label="anchor" href="#read-a-file"></a>
</h4>
<p>Use library to load the needed packages.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">readr</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">lubridate</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">dplyr</span><span class="op">)</span></span></code></pre>
</div>
<p>We will use the <code>read_csv</code> function from
<code>readr</code> package to read a csv of CNC iNaturalist
observations, and the argument we give will be the path to the CSV file.
We will store the observations in an object named
<code>inat_raw</code>.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inat_raw</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">'data/raw/observations-397280.csv'</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Rows: 171155 Columns: 39
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (23): observed_on_string, time_observed_at, time_zone, user_login, user...
dbl  (10): id, user_id, num_identification_agreements, num_identification_di...
lgl   (5): captive_cultivated, private_place_guess, private_latitude, privat...
date  (1): observed_on

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<p><code>inat_raw</code> is stored in memory. It appears in
<strong>Environment</strong> tab. Double click on <code>inat_raw</code>
in <strong>Environment</strong> to see all the data.</p>
<p><code>read_csv</code> provides some info about the CSV.</p>
<ul>
<li>the number of rows and columns</li>
<li>the <strong>delimiter</strong> of the file, which is how values are
separated, a comma <code>","</code>
</li>
<li>the data types for the columns</li>
</ul>
<p>Use <code>glimpse()</code> to see a information about a dataframe.
Number of rows and columns. For each column, we see the name, data type
(<strong>dbl</strong> for number, <strong>chr</strong> for character,
<strong>lgl</strong> for logical. <strong>date</strong> is a data type
from data.frame), and the first few values.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">glimpse</span><span class="op">(</span><span class="va">inat_raw</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Rows: 171,155
Columns: 39
$ id                               &lt;dbl&gt; 2931940, 2934641, 2934854, 2934961, 2…
$ observed_on_string               &lt;chr&gt; "2016-04-14 12:25:00 AM PDT", "Thu Ap…
$ observed_on                      &lt;date&gt; 2016-04-14, 2016-04-14, 2016-04-14, …
$ time_observed_at                 &lt;chr&gt; "2016-04-14 19:25:00 UTC", "2016-04-1…
$ time_zone                        &lt;chr&gt; "Pacific Time (US &amp; Canada)", "Pacifi…
$ user_id                          &lt;dbl&gt; 151043, 10814, 8510, 80445, 80445, 80…
$ user_login                       &lt;chr&gt; "msmorales", "smartrf", "stonebird", …
$ user_name                        &lt;chr&gt; "Michael Morales", "Richard Smart (he…
$ created_at                       &lt;chr&gt; "2016-04-14 07:28:36 UTC", "2016-04-1…
$ updated_at                       &lt;chr&gt; "2021-12-26 06:58:04 UTC", "2018-05-2…
$ quality_grade                    &lt;chr&gt; "research", "needs_id", "needs_id", "…
$ license                          &lt;chr&gt; "CC-BY", "CC-BY-NC", NA, NA, NA, NA, …
$ url                              &lt;chr&gt; "http://www.inaturalist.org/observati…
$ image_url                        &lt;chr&gt; "https://inaturalist-open-data.s3.ama…
$ sound_url                        &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ tag_list                         &lt;chr&gt; NA, NA, "\"Allen's Hummingbird\" \"Se…
$ description                      &lt;chr&gt; "Spotted on a the wall of a planter, …
$ num_identification_agreements    &lt;dbl&gt; 5, 2, 0, 1, 2, 2, 1, 0, 1, 2, 1, 1, 1…
$ num_identification_disagreements &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
$ captive_cultivated               &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FA…
$ oauth_application_id             &lt;dbl&gt; 2, 3, NA, NA, NA, NA, 3, 3, NA, NA, N…
$ place_guess                      &lt;chr&gt; "Olive Lane Walk Pomona, CA 91768", "…
$ latitude                         &lt;dbl&gt; 34.05829, 34.01742, NA, 34.13020, 34.…
$ longitude                        &lt;dbl&gt; -117.8219, -118.2892, NA, -118.8226, …
$ positional_accuracy              &lt;dbl&gt; 4, 5, 220, NA, NA, NA, NA, 17, 55, 55…
$ private_place_guess              &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ private_latitude                 &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ private_longitude                &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ public_positional_accuracy       &lt;dbl&gt; 4, 5, 28888, NA, NA, NA, NA, 17, 55, …
$ geoprivacy                       &lt;chr&gt; NA, NA, "private", NA, NA, NA, NA, NA…
$ taxon_geoprivacy                 &lt;chr&gt; NA, NA, "open", NA, "open", "open", N…
$ coordinates_obscured             &lt;lgl&gt; FALSE, FALSE, TRUE, FALSE, FALSE, FAL…
$ positioning_method               &lt;chr&gt; "gps", NA, NA, NA, NA, NA, NA, NA, NA…
$ positioning_device               &lt;chr&gt; "gps", NA, NA, NA, NA, NA, NA, NA, NA…
$ species_guess                    &lt;chr&gt; "Garden Snail", "Oestroidea", "Allen'…
$ scientific_name                  &lt;chr&gt; "Cornu aspersum", "Oestroidea", "Sela…
$ common_name                      &lt;chr&gt; "Garden Snail", "Bot Flies, Blow Flie…
$ iconic_taxon_name                &lt;chr&gt; "Mollusca", "Insecta", "Aves", "Insec…
$ taxon_id                         &lt;dbl&gt; 480298, 356157, 6359, 54247, 36100, 3…</code></pre>
</div>
<p><code>nrow()</code> returns the number of rows. <code>ncol()</code>
returns the number of columns <code>dim()</code> returns the number of
rows and columns.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">nrow</span><span class="op">(</span><span class="va">inat_raw</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 171155</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ncol</span><span class="op">(</span><span class="va">inat_raw</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 39</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dim</span><span class="op">(</span><span class="va">inat_raw</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 171155     39</code></pre>
</div>
<p><code>names()</code> shows the column names</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">names</span><span class="op">(</span><span class="va">inat_raw</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1] "id"                               "observed_on_string"              
 [3] "observed_on"                      "time_observed_at"                
 [5] "time_zone"                        "user_id"                         
 [7] "user_login"                       "user_name"                       
 [9] "created_at"                       "updated_at"                      
[11] "quality_grade"                    "license"                         
[13] "url"                              "image_url"                       
[15] "sound_url"                        "tag_list"                        
[17] "description"                      "num_identification_agreements"   
[19] "num_identification_disagreements" "captive_cultivated"              
[21] "oauth_application_id"             "place_guess"                     
[23] "latitude"                         "longitude"                       
[25] "positional_accuracy"              "private_place_guess"             
[27] "private_latitude"                 "private_longitude"               
[29] "public_positional_accuracy"       "geoprivacy"                      
[31] "taxon_geoprivacy"                 "coordinates_obscured"            
[33] "positioning_method"               "positioning_device"              
[35] "species_guess"                    "scientific_name"                 
[37] "common_name"                      "iconic_taxon_name"               
[39] "taxon_id"                        </code></pre>
</div>
<p>To access one column, use <code>$</code> and name of the column</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inat_raw</span><span class="op">$</span><span class="va">quality_grade</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  [1] "research" "needs_id" "needs_id" "research" "research" "research"
  [7] "needs_id" "needs_id" "casual"   "research" "research" "research"
 [13] "needs_id" "research" "research" "research" "research" "research"
 [19] "research" "research" "needs_id" "research" "research" "casual"  
 [25] "casual"   "casual"   "casual"   "research" "casual"   "casual"  
 [31] "casual"   "research" "research" "casual"   "research" "needs_id"
 [37] "needs_id" "research" "research" "research" "research" "research"
 [43] "casual"   "needs_id" "research" "research" "research" "needs_id"
 [49] "research" "casual"   "casual"   "casual"   "research" "research"
 [55] "needs_id" "research" "research" "research" "needs_id" "needs_id"
 [61] "research" "needs_id" "research" "research" "casual"   "needs_id"
 [67] "research" "research" "needs_id" "research" "research" "research"
 [73] "needs_id" "needs_id" "research" "research" "casual"   "research"
 [79] "research" "research" "needs_id" "research" "casual"   "needs_id"
 [85] "research" "research" "research" "research" "research" "research"
 [91] "needs_id" "research" "research" "casual"   "research" "needs_id"
 [97] "needs_id" "research" "research" "needs_id"
 [ reached getOption("max.print") -- omitted 171055 entries ]</code></pre>
</div>
<p>To view all the unique values in a column, use
<code>unique()</code></p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">unique</span><span class="op">(</span><span class="va">inat_raw</span><span class="op">$</span><span class="va">quality_grade</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "research" "needs_id" "casual"  </code></pre>
</div>
</div>
</section><section id="manipulating-data"><h2 class="section-heading">Manipulating data<a class="anchor" aria-label="anchor" href="#manipulating-data"></a>
</h2>
<hr class="half-width">
<p>One of the most important skills for working with data in R is the
ability to manipulate, modify, and reshape data. The <code>dplyr</code>
package provide a series of powerful functions for many common data
manipulation tasks.</p>
<p>select() filter() mutate() arrange() count()</p>
<div class="section level4">
<h4 id="select">
<code>select()</code><a class="anchor" aria-label="anchor" href="#select"></a>
</h4>
<p><code>select()</code> picks certain columns of a data.frame. To use
the <code>select()</code> function, the first argument is the name of
the data.frame, and the rest of the arguments are <em>unquoted</em>
names of the columns you want.</p>
<p>iNaturalist has 39 columns. We want four columns. The columns are
arranged in the order we specified inside <code>select()</code>.</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">select</span><span class="op">(</span><span class="va">inat_raw</span>, <span class="va">user_login</span>, <span class="va">common_name</span>, <span class="va">scientific_name</span>, <span class="va">observed_on</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 171,155 × 4
   user_login    common_name                         scientific_name observed_on
   &lt;chr&gt;         &lt;chr&gt;                               &lt;chr&gt;           &lt;date&gt;     
 1 msmorales     Garden Snail                        Cornu aspersum  2016-04-14 
 2 smartrf       Bot Flies, Blow Flies, and Allies   Oestroidea      2016-04-14 
 3 stonebird     Allen's Hummingbird                 Selasphorus sa… 2016-04-14 
 4 cdegroof      California Orange-winged Grasshopp… Arphia ramona   2016-04-14 
 5 cdegroof      Western Side-blotched Lizard        Uta stansburia… 2016-04-14 
 6 cdegroof      Western Fence Lizard                Sceloporus occ… 2016-04-14 
 7 ttempel       &lt;NA&gt;                                Coelocnemis     2016-04-14 
 8 bradrumble    House Sparrow                       Passer domesti… 2016-04-15 
 9 deedeeflower5 Amur Carp                           Cyprinus rubro… 2016-04-14 
10 deedeeflower5 Red-eared Slider                    Trachemys scri… 2016-04-14 
# ℹ 171,145 more rows</code></pre>
</div>
</div>
<div class="section level4">
<h4 id="filter">
<code>filter()</code><a class="anchor" aria-label="anchor" href="#filter"></a>
</h4>
<p>The <code>filter()</code> function is used to select rows that meet
certain criteria. To get all the rows where the value of
<code>common_name</code> is equal to <code>Western Fence Lizard</code>,
we would run the following:</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">filter</span><span class="op">(</span><span class="va">inat_raw</span>, <span class="va">common_name</span> <span class="op">==</span> <span class="st">'Western Fence Lizard'</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 2,970 × 39
        id observed_on_string     observed_on time_observed_at time_zone user_id
     &lt;dbl&gt; &lt;chr&gt;                  &lt;date&gt;      &lt;chr&gt;            &lt;chr&gt;       &lt;dbl&gt;
 1 2934994 2016-04-14 12:19:09    2016-04-14  2016-04-14 19:1… Pacific …   80445
 2 2935263 2016-04-14             2016-04-14  &lt;NA&gt;             Pacific …  216108
 3 2935420 2016-04-14             2016-04-14  &lt;NA&gt;             Pacific …  216108
 4 2935748 2016-04-14 14:01:29    2016-04-14  2016-04-14 21:0… Pacific …   80445
 5 2935965 Thu Apr 14 2016 12:44… 2016-04-14  2016-04-14 19:4… Pacific …  171443
 6 2938607 Thu Apr 14 2016 16:33… 2016-04-14  2016-04-14 23:3… Pacific …  146517
 7 2940103 2016-04-15 9:31:39 AM… 2016-04-15  2016-04-15 16:3… Pacific …   80984
 8 2940838 Fri Apr 15 2016 10:11… 2016-04-15  2016-04-15 17:1… Pacific …  201119
 9 2940848 Fri Apr 15 2016 10:17… 2016-04-15  2016-04-15 17:1… Pacific …  201119
10 2940855 Fri Apr 15 2016 10:42… 2016-04-15  2016-04-15 17:4… Pacific …  201119
# ℹ 2,960 more rows
# ℹ 33 more variables: user_login &lt;chr&gt;, user_name &lt;chr&gt;, created_at &lt;chr&gt;,
#   updated_at &lt;chr&gt;, quality_grade &lt;chr&gt;, license &lt;chr&gt;, url &lt;chr&gt;,
#   image_url &lt;chr&gt;, sound_url &lt;chr&gt;, tag_list &lt;chr&gt;, description &lt;chr&gt;,
#   num_identification_agreements &lt;dbl&gt;,
#   num_identification_disagreements &lt;dbl&gt;, captive_cultivated &lt;lgl&gt;,
#   oauth_application_id &lt;dbl&gt;, place_guess &lt;chr&gt;, latitude &lt;dbl&gt;, …</code></pre>
</div>
<p>The <code>==</code> sign means “is equal to”. There are several other
operators we can use: &gt;, &gt;=, &lt;, &lt;=, and != (not equal
to).</p>
</div>
</section><section id="the-pipe"><h2 class="section-heading">The pipe: <code>%&gt;%</code><a class="anchor" aria-label="anchor" href="#the-pipe"></a>
</h2>
<hr class="half-width">
<p>What happens if we want to both <code>select()</code> and
<code>filter()</code> our data?</p>
<p>We use the pipe operator (<code>%&gt;%</code>) to call multiple
functions. You can insert it by using the keyboard shortcut
<kbd>Shift+Cmd+M</kbd> (Mac) or <kbd>Shift+Ctrl+M</kbd> (Windows).</p>
<p>Get user_login, common_name, scientific_name, observed_on for all
observations where common_name is ‘Western Fence Lizard’. Use filter to
select rows, then use select to select columns.</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inat_raw</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">common_name</span> <span class="op">==</span> <span class="st">'Western Fence Lizard'</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">user_login</span>, <span class="va">common_name</span>, <span class="va">scientific_name</span>, <span class="va">observed_on</span><span class="op">)</span> </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 2,970 × 4
   user_login    common_name          scientific_name         observed_on
   &lt;chr&gt;         &lt;chr&gt;                &lt;chr&gt;                   &lt;date&gt;     
 1 cdegroof      Western Fence Lizard Sceloporus occidentalis 2016-04-14 
 2 deedeeflower5 Western Fence Lizard Sceloporus occidentalis 2016-04-14 
 3 deedeeflower5 Western Fence Lizard Sceloporus occidentalis 2016-04-14 
 4 cdegroof      Western Fence Lizard Sceloporus occidentalis 2016-04-14 
 5 lchroman      Western Fence Lizard Sceloporus occidentalis 2016-04-14 
 6 maiz          Western Fence Lizard Sceloporus occidentalis 2016-04-14 
 7 kimssight     Western Fence Lizard Sceloporus occidentalis 2016-04-15 
 8 sarahwenner   Western Fence Lizard Sceloporus occidentalis 2016-04-15 
 9 sarahwenner   Western Fence Lizard Sceloporus occidentalis 2016-04-15 
10 sarahwenner   Western Fence Lizard Sceloporus occidentalis 2016-04-15 
# ℹ 2,960 more rows</code></pre>
</div>
<p>Pipe operator take the thing on the lefthand side and insert it as
the first argument of the function on the righthand side. By putting
each of our functions onto a new line, we can build a nice, readable
pipeline. It can be useful to think of this as a little assembly line
for our data. It starts at the top and gets piped into a
<code>filter()</code> function, and it comes out modified somewhat. It
then gets sent into the <code>select()</code> function, where it is
further modified, and then the final product gets printed out to our
console. It can also be helpful to think of <code>%&gt;%</code> as
meaning “and then”.</p>
<p>If you want to see all the records, assign the data.frame to an
object.</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="va">inat_raw</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">common_name</span> <span class="op">==</span> <span class="st">'Western Fence Lizard'</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">user_login</span>, <span class="va">common_name</span>, <span class="va">scientific_name</span>, <span class="va">observed_on</span><span class="op">)</span> </span></code></pre>
</div>
<p>We can also use multiple conditions in one <code>filter()</code>
statement.</p>
<p>When researchers use iNaturalist data, the normally use research
grade observations. Here we will get all observations that research
grade and common_name is Western Fence Lizard. use <code>&amp;</code>
for and.</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inat_raw</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span> <span class="va">common_name</span> <span class="op">==</span> <span class="st">'Western Fence Lizard'</span> </span>
<span>         <span class="op">&amp;</span> <span class="va">quality_grade</span> <span class="op">==</span> <span class="st">'research'</span><span class="op">)</span>  <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">user_login</span>, <span class="va">common_name</span>, <span class="va">scientific_name</span>, <span class="va">observed_on</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 2,942 × 4
   user_login    common_name          scientific_name         observed_on
   &lt;chr&gt;         &lt;chr&gt;                &lt;chr&gt;                   &lt;date&gt;     
 1 cdegroof      Western Fence Lizard Sceloporus occidentalis 2016-04-14 
 2 deedeeflower5 Western Fence Lizard Sceloporus occidentalis 2016-04-14 
 3 deedeeflower5 Western Fence Lizard Sceloporus occidentalis 2016-04-14 
 4 cdegroof      Western Fence Lizard Sceloporus occidentalis 2016-04-14 
 5 lchroman      Western Fence Lizard Sceloporus occidentalis 2016-04-14 
 6 maiz          Western Fence Lizard Sceloporus occidentalis 2016-04-14 
 7 kimssight     Western Fence Lizard Sceloporus occidentalis 2016-04-15 
 8 sarahwenner   Western Fence Lizard Sceloporus occidentalis 2016-04-15 
 9 sarahwenner   Western Fence Lizard Sceloporus occidentalis 2016-04-15 
10 sarahwenner   Western Fence Lizard Sceloporus occidentalis 2016-04-15 
# ℹ 2,932 more rows</code></pre>
</div>
<p>Here we will get observations where <code>user_login</code> is
‘natureinla’ and <code>common_name</code> is ‘Western Fence Lizard’.</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inat_raw</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">user_login</span> <span class="op">==</span> <span class="st">'natureinla'</span> <span class="op">&amp;</span> <span class="va">common_name</span> <span class="op">==</span> <span class="st">'Western Fence Lizard'</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">user_login</span>, <span class="va">common_name</span>, <span class="va">scientific_name</span>, <span class="va">observed_on</span><span class="op">)</span> </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 79 × 4
   user_login common_name          scientific_name         observed_on
   &lt;chr&gt;      &lt;chr&gt;                &lt;chr&gt;                   &lt;date&gt;     
 1 natureinla Western Fence Lizard Sceloporus occidentalis 2016-04-16 
 2 natureinla Western Fence Lizard Sceloporus occidentalis 2016-04-16 
 3 natureinla Western Fence Lizard Sceloporus occidentalis 2016-04-17 
 4 natureinla Western Fence Lizard Sceloporus occidentalis 2016-04-16 
 5 natureinla Western Fence Lizard Sceloporus occidentalis 2016-04-17 
 6 natureinla Western Fence Lizard Sceloporus occidentalis 2016-04-17 
 7 natureinla Western Fence Lizard Sceloporus occidentalis 2016-04-19 
 8 natureinla Western Fence Lizard Sceloporus occidentalis 2016-04-16 
 9 natureinla Western Fence Lizard Sceloporus occidentalis 2016-04-18 
10 natureinla Western Fence Lizard Sceloporus occidentalis 2016-04-16 
# ℹ 69 more rows</code></pre>
</div>
<p>Here we will get observations where <code>common_name</code> is
‘Western Fence Lizard’ or ‘Western Honey Bee’. use <code>|</code> for
or.</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inat_raw</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">common_name</span> <span class="op">==</span> <span class="st">'Western Honey Bee'</span> <span class="op">|</span> <span class="va">common_name</span> <span class="op">==</span> <span class="st">'Western Fence Lizard'</span><span class="op">)</span>  <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">user_login</span>, <span class="va">observed_on</span>, <span class="va">common_name</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 4,788 × 3
   user_login    observed_on common_name         
   &lt;chr&gt;         &lt;date&gt;      &lt;chr&gt;               
 1 cdegroof      2016-04-14  Western Fence Lizard
 2 deedeeflower5 2016-04-14  Western Fence Lizard
 3 deedeeflower5 2016-04-14  Western Fence Lizard
 4 cdegroof      2016-04-14  Western Fence Lizard
 5 lchroman      2016-04-14  Western Fence Lizard
 6 smartrf       2016-04-14  Western Honey Bee   
 7 maiz          2016-04-14  Western Fence Lizard
 8 smartrf       2016-04-15  Western Honey Bee   
 9 kimssight     2016-04-15  Western Fence Lizard
10 catherineh    2016-04-15  Western Honey Bee   
# ℹ 4,778 more rows</code></pre>
</div>
<p>Sometimes we want to combine and or. We want observations from
‘cdegroof’ or ‘deedeeflower5’ for ‘Western Fence Lizard’. You can use
both <code>&amp;</code> and <code>|</code> together in a single
filter.</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="va">inat_raw</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">user_login</span> <span class="op">==</span> <span class="st">'cdegroof'</span> </span>
<span>         <span class="op">|</span> <span class="va">user_login</span> <span class="op">==</span> <span class="st">'deedeeflower5'</span></span>
<span>         <span class="op">&amp;</span> <span class="va">common_name</span> <span class="op">==</span> <span class="st">'Western Fence Lizard'</span><span class="op">)</span>  <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">user_login</span>, <span class="va">common_name</span>, <span class="va">scientific_name</span>, <span class="va">observed_on</span><span class="op">)</span></span></code></pre>
</div>
<p>You can also use multiple filter statememts.</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="va">inat_raw</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">user_login</span> <span class="op">==</span> <span class="st">'cdegroof'</span> </span>
<span>         <span class="op">|</span> <span class="va">user_login</span> <span class="op">==</span> <span class="st">'deedeeflower5'</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">common_name</span> <span class="op">==</span> <span class="st">'Western Fence Lizard'</span><span class="op">)</span>  <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">user_login</span>, <span class="va">observed_on</span>, <span class="va">common_name</span><span class="op">)</span></span></code></pre>
</div>
</section><section id="cleaning-up-raw-data-exporting-dataframe"><h2 class="section-heading">Cleaning up raw data, exporting dataframe<a class="anchor" aria-label="anchor" href="#cleaning-up-raw-data-exporting-dataframe"></a>
</h2>
<hr class="half-width">
<p>A common step during data analysis is to clean up the raw data. We
fix any obvious errors, edit column names, exclude rows we do not want,
and save the cleaned up data set. We do the analysis on the cleaned data
set.</p>
<p>We want observation that match these criteria - have a species
information. - have latitude or longitude. - have ‘research’ for
quality_grade</p>
<p>Use <code>colSums(is.na())</code> to count the number of rows that
have NA values for each column.</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">colSums</span><span class="op">(</span><span class="fu">is.na</span><span class="op">(</span><span class="va">inat_raw</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>                              id               observed_on_string 
                               0                                0 
                     observed_on                 time_observed_at 
                               0                             5819 
                       time_zone                          user_id 
                               0                                0 
                      user_login                        user_name 
                               0                            63304 
                      created_at                       updated_at 
                               0                                0 
                   quality_grade                          license 
                               0                            42937 
                             url                        image_url 
                               0                             2214 
                       sound_url                         tag_list 
                          170645                           164464 
                     description    num_identification_agreements 
                          149235                                0 
num_identification_disagreements               captive_cultivated 
                               0                                0 
            oauth_application_id                      place_guess 
                           66613                              440 
                        latitude                        longitude 
                             438                              438 
             positional_accuracy              private_place_guess 
                           38319                           171155 
                private_latitude                private_longitude 
                          171155                           171155 
      public_positional_accuracy                       geoprivacy 
                           34911                           158521 
                taxon_geoprivacy             coordinates_obscured 
                          129409                                0 
              positioning_method               positioning_device 
                          156084                           154467 
                   species_guess                  scientific_name 
                           25721                             1685 
                     common_name                iconic_taxon_name 
                           11164                             1846 
                        taxon_id 
                            1685 </code></pre>
</div>
<p>All rows have id, observed_on, and user_id.</p>
<p>1685 rows don’t have scientific_name. 438 rows don’t have latitude or
longitude.</p>
<p><code>table</code> is a function from base R that can count the
number of unique values in a column. Get a count for
<code>quality_grade</code>.</p>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">table</span><span class="op">(</span><span class="va">inat_raw</span><span class="op">$</span><span class="va">quality_grade</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
  casual needs_id research 
   23194    53875    94086 </code></pre>
</div>
<p>94086 rows are <code>research</code> grade.</p>
<p>use filter to select the observations we want.</p>
<p><code>!is.na</code> will select rows that have are not NA, meaning
rows that have a value. <code>quality_grade == 'research'</code> will
select rows that are ‘research’ grade.</p>
<p>save the cleaned up data in a new object <code>inat</code>.</p>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inat</span> <span class="op">&lt;-</span> <span class="va">inat_raw</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="op">!</span><span class="fu">is.na</span><span class="op">(</span><span class="va">latitude</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>           <span class="op">!</span><span class="fu">is.na</span><span class="op">(</span><span class="va">longitude</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>           <span class="op">!</span><span class="fu">is.na</span><span class="op">(</span><span class="va">scientific_name</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">quality_grade</span> <span class="op">==</span> <span class="st">'research'</span><span class="op">)</span></span></code></pre>
</div>
<p>The original dataframe ‘inat_raw’ had 171K rows, the cleaned
dataframe ‘inat’ has 93K rows.</p>
<p>We can double check our work.</p>
<p>latitude, longitude, scientific_name have zero NA.</p>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">colSums</span><span class="op">(</span><span class="fu">is.na</span><span class="op">(</span><span class="va">inat</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>                              id               observed_on_string 
                               0                                0 
                     observed_on                 time_observed_at 
                               0                             3167 
                       time_zone                          user_id 
                               0                                0 
                      user_login                        user_name 
                               0                            30889 
                      created_at                       updated_at 
                               0                                0 
                   quality_grade                          license 
                               0                            21944 
                             url                        image_url 
                               0                              334 
                       sound_url                         tag_list 
                           93561                            89612 
                     description    num_identification_agreements 
                           82364                                0 
num_identification_disagreements               captive_cultivated 
                               0                                0 
            oauth_application_id                      place_guess 
                           41638                                1 
                        latitude                        longitude 
                               0                                0 
             positional_accuracy              private_place_guess 
                           22494                            93950 
                private_latitude                private_longitude 
                           93950                            93950 
      public_positional_accuracy                       geoprivacy 
                           20663                            87462 
                taxon_geoprivacy             coordinates_obscured 
                           59216                                0 
              positioning_method               positioning_device 
                           84974                            84450 
                   species_guess                  scientific_name 
                             138                                0 
                     common_name                iconic_taxon_name 
                            1626                                4 
                        taxon_id 
                               0 </code></pre>
</div>
<p>quality_grade only has research.</p>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">table</span><span class="op">(</span><span class="va">inat</span><span class="op">$</span><span class="va">quality_grade</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span></span>
<span><span class="va">research</span> </span>
<span>   <span class="fl">93950</span> </span></code></pre>
</div>
<p>We want to save the cleaned up data set so we can use it later. We
can save data.frame to a CSV using the <code>write_csv()</code> function
from the <code>readr</code> package. The first argument is the name of
the data.frame, and the second is the path to the new file we want to
create, including the file extension <code>.csv</code>.</p>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">write_csv</span><span class="op">(</span><span class="va">inat</span>, file<span class="op">=</span> <span class="st">'data/cleaned/observations.csv'</span><span class="op">)</span></span></code></pre>
</div>
<p>If we go look into our <code>cleaned_data</code> folder, we will see
this new CSV file.</p>
</section><section id="errors-in-code"><h2 class="section-heading">Errors in code<a class="anchor" aria-label="anchor" href="#errors-in-code"></a>
</h2>
<hr class="half-width">
<p>We are writing instructions for the computer. If there is typos,
mispelling, pass in wrong arguments into functions, etc, code will not
work and we will see errors. R will display the errors in red.</p>
<p>typo for <code>%&gt;</code></p>
<div class="codewrapper sourceCode" id="cb43">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inat</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">user_login</span>, <span class="va">observed_on</span>, <span class="va">common_name</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">user_login</span> <span class="op">==</span> <span class="st">'natureinla'</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1,528 × 3
   user_login observed_on common_name           
   &lt;chr&gt;      &lt;date&gt;      &lt;chr&gt;                 
 1 natureinla 2016-04-14  Red-eared Slider      
 2 natureinla 2016-04-14  Monarch               
 3 natureinla 2016-04-14  San Diego Gopher Snake
 4 natureinla 2016-04-14  California Towhee     
 5 natureinla 2016-04-14  Cooper's Hawk         
 6 natureinla 2016-04-14  Monarch               
 7 natureinla 2016-04-14  Allen's Hummingbird   
 8 natureinla 2016-04-15  Northern Mockingbird  
 9 natureinla 2016-04-15  House Sparrow         
10 natureinla 2016-04-15  Indian Peafowl        
# ℹ 1,518 more rows</code></pre>
</div>
<p>Misspelled <code>user_logi</code></p>
<div class="codewrapper sourceCode" id="cb45">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inat</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">user_login</span>, <span class="va">observed_on</span>, <span class="va">common_name</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">user_login</span> <span class="op">==</span> <span class="st">'natureinla'</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1,528 × 3
   user_login observed_on common_name           
   &lt;chr&gt;      &lt;date&gt;      &lt;chr&gt;                 
 1 natureinla 2016-04-14  Red-eared Slider      
 2 natureinla 2016-04-14  Monarch               
 3 natureinla 2016-04-14  San Diego Gopher Snake
 4 natureinla 2016-04-14  California Towhee     
 5 natureinla 2016-04-14  Cooper's Hawk         
 6 natureinla 2016-04-14  Monarch               
 7 natureinla 2016-04-14  Allen's Hummingbird   
 8 natureinla 2016-04-15  Northern Mockingbird  
 9 natureinla 2016-04-15  House Sparrow         
10 natureinla 2016-04-15  Indian Peafowl        
# ℹ 1,518 more rows</code></pre>
</div>
<p>typo for <code>=</code></p>
<div class="codewrapper sourceCode" id="cb47">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inat</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">user_login</span>, <span class="va">observed_on</span>, <span class="va">common_name</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">user_login</span> <span class="op">==</span> <span class="st">'natureinla'</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1,528 × 3
   user_login observed_on common_name           
   &lt;chr&gt;      &lt;date&gt;      &lt;chr&gt;                 
 1 natureinla 2016-04-14  Red-eared Slider      
 2 natureinla 2016-04-14  Monarch               
 3 natureinla 2016-04-14  San Diego Gopher Snake
 4 natureinla 2016-04-14  California Towhee     
 5 natureinla 2016-04-14  Cooper's Hawk         
 6 natureinla 2016-04-14  Monarch               
 7 natureinla 2016-04-14  Allen's Hummingbird   
 8 natureinla 2016-04-15  Northern Mockingbird  
 9 natureinla 2016-04-15  House Sparrow         
10 natureinla 2016-04-15  Indian Peafowl        
# ℹ 1,518 more rows</code></pre>
</div>
<p>extra <code>)</code></p>
<div class="codewrapper sourceCode" id="cb49">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inat</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">user_login</span>, <span class="va">observed_on</span>, <span class="va">common_name</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span> <span class="op">(</span><span class="va">user_login</span> <span class="op">==</span> <span class="st">'natureinla'</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1,528 × 3
   user_login observed_on common_name           
   &lt;chr&gt;      &lt;date&gt;      &lt;chr&gt;                 
 1 natureinla 2016-04-14  Red-eared Slider      
 2 natureinla 2016-04-14  Monarch               
 3 natureinla 2016-04-14  San Diego Gopher Snake
 4 natureinla 2016-04-14  California Towhee     
 5 natureinla 2016-04-14  Cooper's Hawk         
 6 natureinla 2016-04-14  Monarch               
 7 natureinla 2016-04-14  Allen's Hummingbird   
 8 natureinla 2016-04-15  Northern Mockingbird  
 9 natureinla 2016-04-15  House Sparrow         
10 natureinla 2016-04-15  Indian Peafowl        
# ℹ 1,518 more rows</code></pre>
</div>
<div id="exercise-1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-1" class="callout-inner">
<h3 class="callout-title">Exercise 1<a class="anchor" aria-label="anchor" href="#exercise-1"></a>
</h3>
<div class="callout-content">
<p>Get your observations for one species. - The data.frame should have
<code>user_login</code>, <code>observed_on</code>,
<code>common-name</code> - Use <code>select()</code>,
<code>filter()</code>, <code>&amp;</code></p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb51">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inat</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">user_login</span> <span class="op">==</span> <span class="st">'natureinla'</span> <span class="op">&amp;</span> <span class="va">common_name</span> <span class="op">==</span> <span class="st">'Red-eared Slider'</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">user_login</span>, <span class="va">observed_on</span>, <span class="va">common_name</span><span class="op">)</span> </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 13 × 3
   user_login observed_on common_name     
   &lt;chr&gt;      &lt;date&gt;      &lt;chr&gt;           
 1 natureinla 2016-04-14  Red-eared Slider
 2 natureinla 2016-04-14  Red-eared Slider
 3 natureinla 2017-04-15  Red-eared Slider
 4 natureinla 2017-04-15  Red-eared Slider
 5 natureinla 2017-04-16  Red-eared Slider
 6 natureinla 2017-04-14  Red-eared Slider
 7 natureinla 2017-04-17  Red-eared Slider
 8 natureinla 2017-04-18  Red-eared Slider
 9 natureinla 2017-04-18  Red-eared Slider
10 natureinla 2017-04-14  Red-eared Slider
11 natureinla 2018-04-30  Red-eared Slider
12 natureinla 2018-04-30  Red-eared Slider
13 natureinla 2019-04-27  Red-eared Slider</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="making-new-columns-with-mutate"><h2 class="section-heading">Making new columns with <code>mutate()</code><a class="anchor" aria-label="anchor" href="#making-new-columns-with-mutate"></a>
</h2>
<hr class="half-width">
<p>Another common task is creating a new column based on values in
existing columns. For example, we could add a new column for year.</p>
<p>Use <code>mutate()</code> to a column. We pass in the name of the new
column, and the value of the column.</p>
<p>Use <code>year()</code> from <code>lubridate</code> on a date column
to get the year.</p>
<p>This code will get the year from ‘observed_on’, and create a ‘year’
column.</p>
<div class="codewrapper sourceCode" id="cb53">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="va">inat</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>year <span class="op">=</span> <span class="fu">year</span><span class="op">(</span><span class="va">observed_on</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>Get observations for 2020.</p>
<div class="codewrapper sourceCode" id="cb54">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inat</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>year <span class="op">=</span> <span class="fu">year</span><span class="op">(</span><span class="va">observed_on</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">year</span> <span class="op">==</span> <span class="fl">2020</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 10,659 × 40
         id observed_on_string    observed_on time_observed_at time_zone user_id
      &lt;dbl&gt; &lt;chr&gt;                 &lt;date&gt;      &lt;chr&gt;            &lt;chr&gt;       &lt;dbl&gt;
 1 43036534 Fri Apr 24 2020 00:0… 2020-04-24  2020-04-24 07:0… Pacific …  146517
 2 43036989 Fri Apr 24 2020 00:0… 2020-04-24  2020-04-24 07:0… Pacific …   74669
 3 43037631 Fri Apr 24 2020 00:1… 2020-04-24  2020-04-24 07:1… Pacific …  403949
 4 43037703 Fri Apr 24 2020 00:1… 2020-04-24  2020-04-24 07:1… Pacific …  403949
 5 43037736 Fri Apr 24 2020 00:0… 2020-04-24  2020-04-24 07:0… Pacific …  403949
 6 43037745 Fri Apr 24 2020 00:1… 2020-04-24  2020-04-24 07:1… Pacific … 2556338
 7 43037824 2020-04-24 12:05:06 … 2020-04-24  2020-04-24 07:0… Pacific … 1628946
 8 43037956 Fri Apr 24 2020 00:1… 2020-04-24  2020-04-24 07:1… Pacific …   74669
 9 43037961 Fri Apr 24 2020 00:2… 2020-04-24  2020-04-24 07:2… Pacific … 2556338
10 43038195 Fri Apr 24 2020 00:2… 2020-04-24  2020-04-24 07:2… Pacific … 2556338
# ℹ 10,649 more rows
# ℹ 34 more variables: user_login &lt;chr&gt;, user_name &lt;chr&gt;, created_at &lt;chr&gt;,
#   updated_at &lt;chr&gt;, quality_grade &lt;chr&gt;, license &lt;chr&gt;, url &lt;chr&gt;,
#   image_url &lt;chr&gt;, sound_url &lt;chr&gt;, tag_list &lt;chr&gt;, description &lt;chr&gt;,
#   num_identification_agreements &lt;dbl&gt;,
#   num_identification_disagreements &lt;dbl&gt;, captive_cultivated &lt;lgl&gt;,
#   oauth_application_id &lt;dbl&gt;, place_guess &lt;chr&gt;, latitude &lt;dbl&gt;, …</code></pre>
</div>
<div id="exercise-2" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-2" class="callout-inner">
<h3 class="callout-title">Exercise 2<a class="anchor" aria-label="anchor" href="#exercise-2"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Create a data.frame with all of your observations from the last
year.</li>
</ol>
<ul>
<li>Use <code>select()</code> , <code>filter()</code>
</li>
<li>Use <code>mutate()</code> and <code>year()</code> to add year
column</li>
<li>The data.frame should have <code>user_login</code>,
<code>observed_on</code>, and <code>common-name</code>.</li>
</ul>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Show me the solution</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb56">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inat</span> <span class="op">%&gt;%</span> </span>
<span>   <span class="fu">mutate</span><span class="op">(</span>year <span class="op">=</span> <span class="fu">year</span><span class="op">(</span><span class="va">observed_on</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">user_login</span> <span class="op">==</span> <span class="st">'natureinla'</span> <span class="op">&amp;</span> <span class="va">year</span> <span class="op">==</span> <span class="fl">2023</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">user_login</span>, <span class="va">observed_on</span>, <span class="va">common_name</span><span class="op">)</span> </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 3 × 3
  user_login observed_on common_name             
  &lt;chr&gt;      &lt;date&gt;      &lt;chr&gt;                   
1 natureinla 2023-04-29  Thick-leaved Yerba Santa
2 natureinla 2023-04-29  Big Berry Manzanita     
3 natureinla 2023-04-29  chamise                 </code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="count-the-number-of-rows-with-count"><h2 class="section-heading">Count the number of rows with <code>count()</code><a class="anchor" aria-label="anchor" href="#count-the-number-of-rows-with-count"></a>
</h2>
<hr class="half-width">
<p>Use <code>count()</code> from dplyr to count the number of values for
one or more columns.</p>
<p>Let’s try counting of all our observations by year. Use
<code>mutate</code> to add a year column. Use <code>count</code> to
count the number of observations for each year. By default, count will
add a new column caled <code>n</code>.</p>
<div class="codewrapper sourceCode" id="cb58">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inat</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>year <span class="op">=</span> <span class="fu">year</span><span class="op">(</span><span class="va">observed_on</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">year</span><span class="op">)</span>  </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 8 × 2
   year     n
  &lt;dbl&gt; &lt;int&gt;
1  2016  5791
2  2017  9354
3  2018 10855
4  2019 17950
5  2020 10659
6  2021 13051
7  2022 11924
8  2023 14366</code></pre>
</div>
<p>We can specify the name of the count column by passing in
<code>name</code> to <code>count()</code></p>
<div class="codewrapper sourceCode" id="cb60">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inat</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>year <span class="op">=</span> <span class="fu">year</span><span class="op">(</span><span class="va">observed_on</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">year</span>, name<span class="op">=</span><span class="st">'obs_count'</span><span class="op">)</span>  </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 8 × 2
   year obs_count
  &lt;dbl&gt;     &lt;int&gt;
1  2016      5791
2  2017      9354
3  2018     10855
4  2019     17950
5  2020     10659
6  2021     13051
7  2022     11924
8  2023     14366</code></pre>
</div>
<p>Let’s count the number of observations for each species. We will pass
in both ‘common_name’ and ‘scientific_name’ because some species don’t
have a common_name.</p>
<div class="codewrapper sourceCode" id="cb62">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inat</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">common_name</span>, <span class="va">scientific_name</span>, name<span class="op">=</span><span class="st">'obs_count'</span><span class="op">)</span>   </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 3,675 × 3
   common_name                 scientific_name         obs_count
   &lt;chr&gt;                       &lt;chr&gt;                       &lt;int&gt;
 1 Abert's Thread-waisted Wasp Ammophila aberti                1
 2 Accipiters                  Accipiter                       2
 3 Acmon Blue                  Icaricia acmon                 35
 4 Acorn Woodpecker            Melanerpes formicivorus       256
 5 Acton's Brittlebush         Encelia actoni                 11
 6 Acute Bladder Snail         Physella acuta                  8
 7 Adams Mussel                Brachidontes adamsianus         4
 8 African Asparagus           Asparagus aethiopicus          22
 9 African Clawed Frog         Xenopus laevis                  1
10 African Cluster Bug         Agonoscelis puberula           13
# ℹ 3,665 more rows</code></pre>
</div>
<p>It’s often useful to take a look at the results in some order, like
the lowest count to highest. We can use the <code>arrange()</code>
function for that. By default, arrange will return values from lowest to
highest.</p>
<div class="codewrapper sourceCode" id="cb64">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inat</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">common_name</span>, <span class="va">scientific_name</span>, name<span class="op">=</span><span class="st">'obs_count'</span><span class="op">)</span>   <span class="op">%&gt;%</span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">obs_count</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 3,675 × 3
   common_name                        scientific_name               obs_count
   &lt;chr&gt;                              &lt;chr&gt;                             &lt;int&gt;
 1 Abert's Thread-waisted Wasp        Ammophila aberti                      1
 2 African Clawed Frog                Xenopus laevis                        1
 3 African boxthorn                   Lycium ferocissimum                   1
 4 Almond                             Prunus amygdalus                      1
 5 Alpine Brown Sunken Disk Lichen    Bellemerea alpina                     1
 6 American Black-crowned Night Heron Nycticorax nycticorax hoactli         1
 7 American Dewdrop Spider            Argyrodes elevatus                    1
 8 American Dipper                    Cinclus mexicanus                     1
 9 American Softshells                Apalone                               1
10 American Sunflower Moth            Homoeosoma electella                  1
# ℹ 3,665 more rows</code></pre>
</div>
<p>If we want to reverse the order, we can wrap the column name in
<code>desc()</code>:</p>
<div class="codewrapper sourceCode" id="cb66">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inat</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">common_name</span>, <span class="va">scientific_name</span>, name<span class="op">=</span><span class="st">'obs_count'</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">obs_count</span><span class="op">)</span><span class="op">)</span> </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 3,675 × 3
   common_name            scientific_name         obs_count
   &lt;chr&gt;                  &lt;chr&gt;                       &lt;int&gt;
 1 Western Fence Lizard   Sceloporus occidentalis      2936
 2 Western Honey Bee      Apis mellifera               1803
 3 Fox Squirrel           Sciurus niger                1285
 4 House Finch            Haemorhous mexicanus         1067
 5 Mourning Dove          Zenaida macroura             1034
 6 Mallard                Anas platyrhynchos            810
 7 House Sparrow          Passer domesticus             800
 8 Convergent Lady Beetle Hippodamia convergens         788
 9 California Towhee      Melozone crissalis            747
10 Northern Mockingbird   Mimus polyglottos             719
# ℹ 3,665 more rows</code></pre>
</div>
<p>use <code>slice()</code> to return only certain number of records
slice(start:end)</p>
<p>Top ten species with the most observations.</p>
<div class="codewrapper sourceCode" id="cb68">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inat</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">common_name</span>, <span class="va">scientific_name</span>, name<span class="op">=</span><span class="st">'obs_count'</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">obs_count</span><span class="op">)</span><span class="op">)</span>  <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">slice</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 10 × 3
   common_name            scientific_name         obs_count
   &lt;chr&gt;                  &lt;chr&gt;                       &lt;int&gt;
 1 Western Fence Lizard   Sceloporus occidentalis      2936
 2 Western Honey Bee      Apis mellifera               1803
 3 Fox Squirrel           Sciurus niger                1285
 4 House Finch            Haemorhous mexicanus         1067
 5 Mourning Dove          Zenaida macroura             1034
 6 Mallard                Anas platyrhynchos            810
 7 House Sparrow          Passer domesticus             800
 8 Convergent Lady Beetle Hippodamia convergens         788
 9 California Towhee      Melozone crissalis            747
10 Northern Mockingbird   Mimus polyglottos             719</code></pre>
</div>
<div id="exercise-3" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-3" class="callout-inner">
<h3 class="callout-title">Exercise 3<a class="anchor" aria-label="anchor" href="#exercise-3"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Create a data.frame with that counts your observation by year</li>
</ol>
<ul>
<li>Use <code>filter()</code> and <code>count()</code>
</li>
<li>Use <code>mutate()</code> and <code>year()</code> to add year
column</li>
</ul>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">Show me the solution</h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb70">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inat</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>year <span class="op">=</span> <span class="fu">year</span><span class="op">(</span><span class="va">observed_on</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">user_login</span> <span class="op">==</span> <span class="st">'natureinla'</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">year</span>, name<span class="op">=</span><span class="st">'obs_count'</span><span class="op">)</span>   </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 7 × 2
   year obs_count
  &lt;dbl&gt;     &lt;int&gt;
1  2016       490
2  2017       606
3  2018       223
4  2019       195
5  2020         9
6  2021         2
7  2023         3</code></pre>
</div>
</div>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section><section id="aio-5_visualizing-ggplot"><p>Content from <a href="5_visualizing-ggplot.html">Data visualization with ggplot2</a></p>
<hr>
<p>Last updated on 2024-05-24 |
        
        <a href="https://github.com/wykhuh/CNC-coding-workshop/edit/main/episodes/5_visualizing-ggplot.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do we create graphs using R?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Learn how to create bar and line charts using ggplot2</li>
<li>Learn how to customize the appearance of the charts</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">ggplot2</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">readr</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">dplyr</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">lubridate</span><span class="op">)</span></span></code></pre>
</div>
<section id="creating-graphs"><h2 class="section-heading">Creating graphs<a class="anchor" aria-label="anchor" href="#creating-graphs"></a>
</h2>
<hr class="half-width">
<p>We are going to be using functions from the
<strong><code>ggplot2</code></strong> package to create visualizations.
<strong><code>ggplot</code></strong> plots are built step by step by
adding new layers, which allows for extensive customization of
plots.</p>
<p>We call <code>ggplot()</code> function, and pass in data and
mappings. Then we call a <code>geom_</code> function to create the
plot.</p>
<p><code>ggplot(data = &lt;DATA&gt;, mapping = aes(&lt;MAPPINGS&gt;)) + &lt;GEOM_FUNCTION&gt;()</code></p>
</section><section id="setup"><h2 class="section-heading">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<hr class="half-width">
<p>First, read data from the cleaned iNaturalist observation file.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inat</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">'data/cleaned/observations.csv'</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Rows: 93950 Columns: 39
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (23): observed_on_string, time_observed_at, time_zone, user_login, user...
dbl  (10): id, user_id, num_identification_agreements, num_identification_di...
lgl   (5): captive_cultivated, private_place_guess, private_latitude, privat...
date  (1): observed_on

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</section><section id="bar-chart"><h2 class="section-heading">Bar chart<a class="anchor" aria-label="anchor" href="#bar-chart"></a>
</h2>
<hr class="half-width">
<p>Create a bar chart that shows the number of observations per
year.</p>
<p>First, add year column to iNaturalist data.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inat_year</span> <span class="op">&lt;-</span> <span class="va">inat</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>year <span class="op">=</span> <span class="fu">year</span><span class="op">(</span><span class="va">observed_on</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>Pass the data to ggplot.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">inat_year</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/5_visualizing-ggplot-rendered-unnamed-chunk-3-1.png" width="600" height="600" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>We need tell ggplot how to process the data. We tell ggplot how to
map the data to various plot elements, such as x/y axis, size, or color
by using the <code>aes()</code> function.<br>
For bar charts, we need to tell what column to use for the x axis. We
want to create a plot with years on the x axis so we use
<code>mapping = aes(x = year)</code>. ggplot will count the number of
rows for each year, and use the count for y axis.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">inat_year</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p><img src="fig/5_visualizing-ggplot-rendered-unnamed-chunk-4-1.png" width="600" height="600" style="display: block; margin: auto;" class="figure">
Next we need to specify how we want the data to be displayed. We do this
using <code>geom_</code> functions, which specify the type of geometry
we want, such as points, lines, or bars. We use <code>geom_bar()</code>
to create a vertical bar plot.</p>
<p>We can add a <code>geom_bar()</code> layer to our plot by using the
<code>+</code> sign. We indent onto a new line to make it easier to
read, and we have to <strong>end</strong> the first line with the
<code>+</code> sign.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">inat_year</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p><img src="fig/5_visualizing-ggplot-rendered-unnamed-chunk-5-1.png" width="600" height="600" style="display: block; margin: auto;" class="figure">
If we want year on x axis, and count on y axis, use
<code>coord_flip()</code></p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">inat_year</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_flip</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/5_visualizing-ggplot-rendered-unnamed-chunk-6-1.png" width="600" height="600" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></section><section id="line-chart"><h2 class="section-heading">Line chart<a class="anchor" aria-label="anchor" href="#line-chart"></a>
</h2>
<hr class="half-width">
<p>Create a line chart that shows the number of observations per
year.</p>
<p>For line charts, we need both x and y variables. Create a dataframe
that count the number of observations by year.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inat_year_count</span> <span class="op">&lt;-</span> <span class="va">inat</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>year <span class="op">=</span> <span class="fu">year</span><span class="op">(</span><span class="va">observed_on</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">year</span>, name<span class="op">=</span><span class="st">'obs_count'</span><span class="op">)</span>  </span>
<span></span>
<span><span class="va">inat_year_count</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 8 × 2
   year obs_count
  &lt;dbl&gt;     &lt;int&gt;
1  2016      5791
2  2017      9354
3  2018     10855
4  2019     17950
5  2020     10659
6  2021     13051
7  2022     11924
8  2023     14366</code></pre>
</div>
<p>We use year on the x axis and obs_count on the y axis. And we use
<code>geom_line()</code> for to create a line chart.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">inat_year_count</span>, </span>
<span>       mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y<span class="op">=</span><span class="va">obs_count</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/5_visualizing-ggplot-rendered-scatter-plot-1.png" width="600" height="600" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></section><section id="more-bar-plots"><h2 class="section-heading">More bar plots<a class="anchor" aria-label="anchor" href="#more-bar-plots"></a>
</h2>
<hr class="half-width">
<p>To create bar chart when we already have x and y, use
<code>geom_col()</code></p>
<p>We want year on the x axis, and count on the y axis.</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">inat_year_count</span>, </span>
<span>       mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">obs_count</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_col</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/5_visualizing-ggplot-rendered-unnamed-chunk-8-1.png" width="600" height="600" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="exercise-1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-1" class="callout-inner">
<h3 class="callout-title">Exercise 1<a class="anchor" aria-label="anchor" href="#exercise-1"></a>
</h3>
<div class="callout-content">
<p>Create a chart with all your observations for each year - Use
<code>mutate()</code> and <code>filter()</code> -</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_year</span>  <span class="op">&lt;-</span> <span class="va">inat</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>year <span class="op">=</span> <span class="fu">year</span><span class="op">(</span><span class="va">observed_on</span><span class="op">)</span><span class="op">)</span>  <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">user_login</span> <span class="op">==</span> <span class="st">'natureinla'</span><span class="op">)</span></span>
<span></span>
<span>  </span>
<span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">my_year</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/5_visualizing-ggplot-rendered-unnamed-chunk-9-1.png" width="600" height="600" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
</section><section id="changing-aesthetics"><h2 class="section-heading">Changing aesthetics<a class="anchor" aria-label="anchor" href="#changing-aesthetics"></a>
</h2>
<hr class="half-width">
<p>Building <strong><code>ggplot</code></strong> plots is often an
iterative process, so we’ll continue developing the column plot we just
made. We can change the color of the bars using
<code>fill='color'</code>.</p>
<p>Use <code>colors()</code> to get a list of the 657 colors in R.</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">colors</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  [1] "white"           "aliceblue"       "antiquewhite"    "antiquewhite1"  
  [5] "antiquewhite2"   "antiquewhite3"   "antiquewhite4"   "aquamarine"     
  [9] "aquamarine1"     "aquamarine2"     "aquamarine3"     "aquamarine4"    
 [13] "azure"           "azure1"          "azure2"          "azure3"         
 [17] "azure4"          "beige"           "bisque"          "bisque1"        
 [21] "bisque2"         "bisque3"         "bisque4"         "black"          
 [25] "blanchedalmond"  "blue"            "blue1"           "blue2"          
 [29] "blue3"           "blue4"           "blueviolet"      "brown"          
 [33] "brown1"          "brown2"          "brown3"          "brown4"         
 [37] "burlywood"       "burlywood1"      "burlywood2"      "burlywood3"     
 [41] "burlywood4"      "cadetblue"       "cadetblue1"      "cadetblue2"     
 [45] "cadetblue3"      "cadetblue4"      "chartreuse"      "chartreuse1"    
 [49] "chartreuse2"     "chartreuse3"     "chartreuse4"     "chocolate"      
 [53] "chocolate1"      "chocolate2"      "chocolate3"      "chocolate4"     
 [57] "coral"           "coral1"          "coral2"          "coral3"         
 [61] "coral4"          "cornflowerblue"  "cornsilk"        "cornsilk1"      
 [65] "cornsilk2"       "cornsilk3"       "cornsilk4"       "cyan"           
 [69] "cyan1"           "cyan2"           "cyan3"           "cyan4"          
 [73] "darkblue"        "darkcyan"        "darkgoldenrod"   "darkgoldenrod1" 
 [77] "darkgoldenrod2"  "darkgoldenrod3"  "darkgoldenrod4"  "darkgray"       
 [81] "darkgreen"       "darkgrey"        "darkkhaki"       "darkmagenta"    
 [85] "darkolivegreen"  "darkolivegreen1" "darkolivegreen2" "darkolivegreen3"
 [89] "darkolivegreen4" "darkorange"      "darkorange1"     "darkorange2"    
 [93] "darkorange3"     "darkorange4"     "darkorchid"      "darkorchid1"    
 [97] "darkorchid2"     "darkorchid3"     "darkorchid4"     "darkred"        
 [ reached getOption("max.print") -- omitted 557 entries ]</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">inat_year</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>fill<span class="op">=</span><span class="st">'aquamarine'</span><span class="op">)</span></span></code></pre>
</div>
<p><img src="fig/5_visualizing-ggplot-rendered-unnamed-chunk-11-1.png" width="600" height="600" style="display: block; margin: auto;" class="figure">
We can also use 6 digit hex color. You can use online tools to get hex
colors. <a href="https://html-color.codes" class="external-link uri">https://html-color.codes</a></p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">inat_year</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>fill<span class="op">=</span><span class="st">'#75cd5e'</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/5_visualizing-ggplot-rendered-unnamed-chunk-12-1.png" width="600" height="600" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></section><section id="adding-another-variable"><h2 class="section-heading">Adding another variable<a class="anchor" aria-label="anchor" href="#adding-another-variable"></a>
</h2>
<hr class="half-width">
<p>iNaturalist has af field called <code>iconic_taxon_name</code> that
assigns each taxa name to a some commonly known groups.</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">unique</span><span class="op">(</span><span class="va">inat</span><span class="op">$</span><span class="va">iconic_taxon_name</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1] "Mollusca"       "Insecta"        "Reptilia"       "Aves"          
 [5] "Mammalia"       "Plantae"        "Animalia"       "Arachnida"     
 [9] "Amphibia"       "Fungi"          "Chromista"      "Actinopterygii"
[13] NA               "Protozoa"      </code></pre>
</div>
<p>Create charts that show the observations per year, and subdivide each
year by <code>iconic_taxon_name.</code> Give each
<code>iconic_taxon_name</code> a different color.</p>
<p>Since we’re now mapping a variable (<code>iconic_taxon_name.</code>)
to a component of the ggplot2 plot (<code>fill</code>), we need to put
the argument inside <code>aes()</code>.</p>
<p>Create a bar chart that shows iconic_taxon_name by color.</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">inat_year</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, fill<span class="op">=</span><span class="va">iconic_taxon_name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p><img src="fig/5_visualizing-ggplot-rendered-unnamed-chunk-14-1.png" width="600" height="600" style="display: block; margin: auto;" class="figure">
We create a new dataframe that counts the number observations per year
and iconic_taxon_name. Use <code>mutate()</code> and <code>year()</code>
to add a <code>year</code> column. We want count by both
<code>year</code> and <code>iconic_taxon_name</code>. We want the column
to be called <code>obs_count</code>.</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inat_year_iconic_count</span> <span class="op">&lt;-</span> <span class="va">inat</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>year <span class="op">=</span> <span class="fu">year</span><span class="op">(</span><span class="va">observed_on</span><span class="op">)</span><span class="op">)</span>  <span class="op">%&gt;%</span></span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">year</span>, <span class="va">iconic_taxon_name</span>, name<span class="op">=</span><span class="st">'obs_count'</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">inat_year_iconic_count</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 107 × 3
    year iconic_taxon_name obs_count
   &lt;dbl&gt; &lt;chr&gt;                 &lt;int&gt;
 1  2016 Actinopterygii            1
 2  2016 Amphibia                 87
 3  2016 Animalia                 87
 4  2016 Arachnida                99
 5  2016 Aves                    976
 6  2016 Chromista                 9
 7  2016 Fungi                    24
 8  2016 Insecta                1325
 9  2016 Mammalia                192
10  2016 Mollusca                183
# ℹ 97 more rows</code></pre>
</div>
<p>Create a line chart that shows iconic_taxon_name by color.</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inat_year_iconic_count</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">obs_count</span>, color <span class="op">=</span> <span class="va">iconic_taxon_name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/5_visualizing-ggplot-rendered-unnamed-chunk-16-1.png" width="600" height="600" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></section><section id="changing-scales"><h2 class="section-heading">Changing scales<a class="anchor" aria-label="anchor" href="#changing-scales"></a>
</h2>
<hr class="half-width">
<p>The default color scheme isn’t friendly to viewers with
colorblindness. <strong><code>ggplot2</code></strong> comes with quite a
few other color scales, including <code>viridis</code> scales, which are
designed to be colorblind and grayscale friendly. See a list of color
scales. <a href="https://ggplot2.tidyverse.org/reference/scale_colour_continuous.html" class="external-link uri">https://ggplot2.tidyverse.org/reference/scale_colour_continuous.html</a></p>
<p>We can change scales by adding <code>scale_</code> functions to our
plots:</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">inat_year</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, fill<span class="op">=</span><span class="va">iconic_taxon_name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_viridis_d</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/5_visualizing-ggplot-rendered-unnamed-chunk-17-1.png" width="600" height="600" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></section><section id="changing-themes"><h2 class="section-heading">Changing themes<a class="anchor" aria-label="anchor" href="#changing-themes"></a>
</h2>
<hr class="half-width">
<p>we can assign a plot to an object</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myplot</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">inat_year</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>fill<span class="op">=</span><span class="st">'#75cd5e'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">myplot</span></span></code></pre>
</div>
<figure><img src="fig/5_visualizing-ggplot-rendered-unnamed-chunk-18-1.png" width="600" height="600" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>We can change the overall appearance using <code>theme_</code>
functions. Let’s try a black-and-white theme by adding
<code>theme_bw()</code> to our plot:</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myplot</span> <span class="op">+</span> </span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/5_visualizing-ggplot-rendered-theme-bw-1.png" width="600" height="600" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>To see a list of available themes in ggplot, visit <a href="https://ggplot2.tidyverse.org/reference/index.html#themes" class="external-link uri">https://ggplot2.tidyverse.org/reference/index.html#themes</a></p>
<p>To individually change parts of a plot, we can use the
<code>theme()</code> function, which can take many different arguments
to change things about the text, grid lines, background color, and
more.</p>
<p>Let’s try changing the size of the text on our axis titles. We can do
this by specifying that the <code>axis.title</code> should be an
<code>element_text()</code> with <code>size</code> set to 14.</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myplot</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/5_visualizing-ggplot-rendered-text-size-1.png" width="600" height="600" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Another change we might want to make is to remove the vertical grid
lines. To do this, inside <code>theme()</code>, we will change the
<code>panel.grid.major.x</code> to an <code>element_blank()</code>.</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myplot</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span>, </span>
<span>        panel.grid.major.x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>        panel.grid.minor.x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/5_visualizing-ggplot-rendered-element-blank-1.png" width="600" height="600" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Because there are so many possible arguments to the
<code>theme()</code> function, it can sometimes be hard to find the
right one. Here are some tips for figuring out how to modify a plot
element:</p>
<ul>
<li>type out <code>theme()</code>, put your cursor between the
parentheses, and hit <kbd>Tab</kbd> to bring up a list of arguments
<ul>
<li>you can scroll through the arguments, or start typing, which will
shorten the list of potential matches</li>
</ul>
</li>
<li>like many things in the <code>tidyverse</code>, similar argument
start with similar names
<ul>
<li>there are <code>axis</code>, <code>legend</code>,
<code>panel</code>, <code>plot</code>, and <code>strip</code>
arguments</li>
</ul>
</li>
<li>arguments have hierarchy
<ul>
<li>
<code>text</code> controls all text in the whole plot</li>
<li>
<code>axis.title</code> controls the text for the axis titles</li>
<li>
<code>axis.title.x</code> controls the text for the x axis
title</li>
</ul>
</li>
</ul></section><section id="changing-labels"><h2 class="section-heading">Changing labels<a class="anchor" aria-label="anchor" href="#changing-labels"></a>
</h2>
<hr class="half-width">
<p>We customize the axis labels and add a chart title
<code>labs()</code> function.</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myplot</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span>, </span>
<span>        plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"CNC Los Angeles"</span>,</span>
<span>       subtitle<span class="op">=</span><span class="st">"Observations per year"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Observations"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/5_visualizing-ggplot-rendered-labels-1.png" width="600" height="600" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="exercise-2-customizing-a-plot" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-2-customizing-a-plot" class="callout-inner">
<h3 class="callout-title">Exercise 2: Customizing a plot<a class="anchor" aria-label="anchor" href="#exercise-2-customizing-a-plot"></a>
</h3>
<div class="callout-content">
<p>Take the chart from exercise 1 (your observations for each year) and
assign it to an object.</p>
<p>Customize the appearance. Here are some ideas. - add a title - choose
the one of the built in themes - change the axis titles - change the
colors of the bar or line</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Show me the solution</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_yearly_plot</span>  <span class="op">&lt;-</span> <span class="va">inat</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>year <span class="op">=</span> <span class="fu">year</span><span class="op">(</span><span class="va">observed_on</span><span class="op">)</span><span class="op">)</span>  <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">user_login</span> <span class="op">==</span> <span class="st">'natureinla'</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">my_year</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>fill<span class="op">=</span><span class="st">'#E0A90A'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">my_yearly_plot</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"CNC Los Angeles"</span>,  x <span class="op">=</span> <span class="st">"Year"</span>,  y <span class="op">=</span> <span class="st">"Observations"</span><span class="op">)</span> </span></code></pre>
</div>
<figure><img src="fig/5_visualizing-ggplot-rendered-unnamed-chunk-19-1.png" width="600" height="600" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
</section><section id="exporting-plots"><h2 class="section-heading">Exporting plots<a class="anchor" aria-label="anchor" href="#exporting-plots"></a>
</h2>
<hr class="half-width">
<p>Once we are happy with ourplot, we can export the plot.</p>
<p>Assign the plot to an object. Then run <code>ggsave()</code> to save
our plot. The first argument we give is the path to the file we want to
save, including the correct file extension. You can save as jpb, pdf,
tiff, png. Next, we tell it the name of the plot object we want to save.
We can also specify things like the width and height of the plot in
inches.</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">finalplot</span> <span class="op">&lt;-</span> <span class="va">myplot</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span>, </span>
<span>        plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"CNC Los Angeles"</span>,</span>
<span>       subtitle<span class="op">=</span><span class="st">"Observations per year"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Observations"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggsave</span><span class="op">(</span>filename <span class="op">=</span> <span class="st">'data/cleaned/observations_per_year.jpg'</span>, plot <span class="op">=</span> <span class="va">finalplot</span>,  height <span class="op">=</span> <span class="fl">6</span>, width <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code></pre>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section><section id="aio-6_creating_maps"><p>Content from <a href="6_creating_maps.html">Creating maps</a></p>
<hr>
<p>Last updated on 2024-05-24 |
        
        <a href="https://github.com/wykhuh/CNC-coding-workshop/edit/main/episodes/6_creating_maps.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do we create maps using R?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Learn how to create static maps with ggplot2</li>
<li>Learn how to create interactive maps with mapview</li>
<li>Learn how to plot iNaturalist observations on a map</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">sf</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">dplyr</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">readr</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">ggplot2</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">mapview</span><span class="op">)</span></span></code></pre>
</div>
<section id="geographic-data"><h2 class="section-heading">Geographic data<a class="anchor" aria-label="anchor" href="#geographic-data"></a>
</h2>
<hr class="half-width">
<p>There are various file formats for geographic data. Shape files for
GIS applications, KML for Google maps, geojson for web applications.</p>
<p>You can get boundaries for countries, states, cities, etc from
various sources. I googled “Los Angeles county boundary shape” which had
a link to “County Boundary | City of Los Angeles Hub - LA GeoHub” <a href="https://geohub.lacity.org/datasets/10f1e37c065347e693cf4e8ee753c09b" class="external-link uri">https://geohub.lacity.org/datasets/10f1e37c065347e693cf4e8ee753c09b</a>
I downloaded the shapefile for LA county.</p>
<p>You can also create your boundaries using GIS applications or GIS web
applications.</p>
</section><section id="mapping-inaturalist-data"><h2 class="section-heading">Mapping iNaturalist data<a class="anchor" aria-label="anchor" href="#mapping-inaturalist-data"></a>
</h2>
<hr class="half-width">
<p>iNaturalist data includes latitude and longitude, which means we can
put the observations in a map. There are several packages to create
maps. We will use ggplot and mapview packages.</p>
<p>First, read data from the cleaned iNaturalist observation file.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inat</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">'data/cleaned/observations.csv'</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Rows: 93950 Columns: 39
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (23): observed_on_string, time_observed_at, time_zone, user_login, user...
dbl  (10): id, user_id, num_identification_agreements, num_identification_di...
lgl   (5): captive_cultivated, private_place_guess, private_latitude, privat...
date  (1): observed_on

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<p>See all the column names. “latitude” and “longitude” are the column
names we need.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">names</span><span class="op">(</span><span class="va">inat</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1] "id"                               "observed_on_string"              
 [3] "observed_on"                      "time_observed_at"                
 [5] "time_zone"                        "user_id"                         
 [7] "user_login"                       "user_name"                       
 [9] "created_at"                       "updated_at"                      
[11] "quality_grade"                    "license"                         
[13] "url"                              "image_url"                       
[15] "sound_url"                        "tag_list"                        
[17] "description"                      "num_identification_agreements"   
[19] "num_identification_disagreements" "captive_cultivated"              
[21] "oauth_application_id"             "place_guess"                     
[23] "latitude"                         "longitude"                       
[25] "positional_accuracy"              "private_place_guess"             
[27] "private_latitude"                 "private_longitude"               
[29] "public_positional_accuracy"       "geoprivacy"                      
[31] "taxon_geoprivacy"                 "coordinates_obscured"            
[33] "positioning_method"               "positioning_device"              
[35] "species_guess"                    "scientific_name"                 
[37] "common_name"                      "iconic_taxon_name"               
[39] "taxon_id"                        </code></pre>
</div>
<p>We use the sf package to add geographic data to our dataframe.
<code>st_as_sf()</code> from <code>sf</code> package will take the
longitude and latitude and add a <code>geometry</code> column that we
can use for mapping.</p>
<ul>
<li>We pass in longitude and latitude columns to coors argument. Must
wrap longitude and latitude in quotes.</li>
<li>crs is coordinate reference system.</li>
<li>
<code>remove=FALSE</code> will keep the cooridate columns in the
dataframe</li>
</ul>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="va">inat</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">st_as_sf</span><span class="op">(</span>coords <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"longitude"</span>, <span class="st">"latitude"</span><span class="op">)</span>,   crs <span class="op">=</span> <span class="fl">4326</span>, remove<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
</div>
<p>use <code>names()</code> to get a list of all the columns. A
<code>geometry</code> column was added.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">names</span><span class="op">(</span><span class="va">temp</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1] "id"                               "observed_on_string"              
 [3] "observed_on"                      "time_observed_at"                
 [5] "time_zone"                        "user_id"                         
 [7] "user_login"                       "user_name"                       
 [9] "created_at"                       "updated_at"                      
[11] "quality_grade"                    "license"                         
[13] "url"                              "image_url"                       
[15] "sound_url"                        "tag_list"                        
[17] "description"                      "num_identification_agreements"   
[19] "num_identification_disagreements" "captive_cultivated"              
[21] "oauth_application_id"             "place_guess"                     
[23] "latitude"                         "longitude"                       
[25] "positional_accuracy"              "private_place_guess"             
[27] "private_latitude"                 "private_longitude"               
[29] "public_positional_accuracy"       "geoprivacy"                      
[31] "taxon_geoprivacy"                 "coordinates_obscured"            
[33] "positioning_method"               "positioning_device"              
[35] "species_guess"                    "scientific_name"                 
[37] "common_name"                      "iconic_taxon_name"               
[39] "taxon_id"                         "geometry"                        </code></pre>
</div>
<p>use select to pick which columns to use.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inat_map</span> <span class="op">&lt;-</span> <span class="va">inat</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">st_as_sf</span><span class="op">(</span>coords <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"longitude"</span>, <span class="st">"latitude"</span><span class="op">)</span>,   crs <span class="op">=</span> <span class="fl">4326</span>, remove<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">id</span>, <span class="va">user_login</span>, <span class="va">common_name</span>, <span class="va">scientific_name</span>, <span class="va">observed_on</span>,  <span class="va">url</span>, <span class="va">longitude</span>, <span class="va">latitude</span>, <span class="va">geometry</span><span class="op">)</span> </span></code></pre>
</div>
</section><section id="static-map"><h2 class="section-heading">static map<a class="anchor" aria-label="anchor" href="#static-map"></a>
</h2>
<hr class="half-width">
<p>Use ggplot to plot the observations. <code>geom_sf</code> will use
<code>geometry</code> column to produce a map.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">inat_map</span><span class="op">)</span>  </span></code></pre>
</div>
<p><img src="fig/6_creating_maps-rendered-unnamed-chunk-7-1.png" width="600" height="600" style="display: block; margin: auto;" class="figure">
There are some observations that are outside of Los Angeles. Use filter
to select observations in LA.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inat_map</span> <span class="op">&lt;-</span> <span class="va">inat_map</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">latitude</span> <span class="op">&lt;</span> <span class="fl">40</span><span class="op">)</span>  </span></code></pre>
</div>
<p>create map with ggplot.</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">inat_map</span><span class="op">)</span>  </span></code></pre>
</div>
<figure><img src="fig/6_creating_maps-rendered-unnamed-chunk-9-1.png" width="600" height="600" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Use <code>dim()</code> to show the number of rows and columns. There
are over 90K rows.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dim</span><span class="op">(</span><span class="va">inat_map</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 93948     9</code></pre>
</div>
</section><section id="interactive-map"><h2 class="section-heading">interactive map<a class="anchor" aria-label="anchor" href="#interactive-map"></a>
</h2>
<hr class="half-width">
<p>use mapview package to create interactive maps.</p>
<p>Since there are over 90K rows, an interactive map will be very slow.
I suggest not using mapview if there are lots of rows.</p>
<p>To speed up the interactive map, let’s filter the list of
observations. Get all observations for Western Fence Lizard.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inat_lizard</span> <span class="op">&lt;-</span> <span class="va">inat_map</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">common_name</span> <span class="op">==</span> <span class="st">'Western Fence Lizard'</span><span class="op">)</span></span></code></pre>
</div>
<p>Use dim to get number of rows. About 3000 rows.</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dim</span><span class="op">(</span><span class="va">inat_lizard</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2936    9</code></pre>
</div>
<p>Create interactive map. You can zoom in and out. Click on observation
to see the info.</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mapview</span><span class="op">(</span><span class="va">inat_lizard</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/6_creating_maps-rendered-unnamed-chunk-13-1.png" width="600" height="600" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></section><section id="working-with-other-geographic-files"><h2 class="section-heading">working with other geographic files<a class="anchor" aria-label="anchor" href="#working-with-other-geographic-files"></a>
</h2>
<hr class="half-width">
<p>Let’s add LA county boundaries to the map.</p>
<p>I downloaded the LA county boundaries from <a href="https://geohub.lacity.org/datasets/lacounty" class="external-link uri">https://geohub.lacity.org/datasets/lacounty</a>::county-boundaries/explore</p>
<p>use <code>read_sf()</code> from <code>sf</code> package to read the
shape file.</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">la_county</span> <span class="op">&lt;-</span> <span class="fu">read_sf</span><span class="op">(</span><span class="st">'data/raw/County_Boundary/County_Boundary.shp'</span><span class="op">)</span></span>
<span>                     </span>
<span>                    </span>
<span><span class="va">la_county</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Simple feature collection with 7 features and 17 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: -118.9446 ymin: 32.79521 xmax: -117.6464 ymax: 34.8233
Geodetic CRS:  WGS 84
# A tibble: 7 × 18
   CITY CITY_ID CITY_TYPE      CITY_NAME     CITY_LABEL COLOR_CODE ABBR  CITY_NO
  &lt;int&gt;   &lt;int&gt; &lt;chr&gt;          &lt;chr&gt;         &lt;chr&gt;           &lt;int&gt; &lt;chr&gt;   &lt;int&gt;
1   250      31 Unincorporated Unincorporat… Unincorpo…          1 UNIN        0
2   250      31 Unincorporated Unincorporat… Unincorpo…          1 UNIN        0
3   250      31 Unincorporated Unincorporat… Unincorpo…          1 UNIN        0
4   250      31 Unincorporated Unincorporat… Unincorpo…          1 UNIN        0
5   250      31 Unincorporated Unincorporat… Unincorpo…          1 UNIN        0
6   250      31 Unincorporated Unincorporat… Unincorpo…          1 UNIN        0
7   250      31 Unincorporated Unincorporat… Unincorpo…          1 UNIN        0
# ℹ 10 more variables: DESCRIPTN &lt;chr&gt;, URL &lt;chr&gt;, PHONE &lt;chr&gt;,
#   OF_AREA_SM &lt;int&gt;, FEAT_TYPE &lt;chr&gt;, COMMENT &lt;chr&gt;, SUB_TYPE &lt;int&gt;,
#   COLOR &lt;chr&gt;, OBJECTID &lt;int&gt;, geometry &lt;MULTIPOLYGON [°]&gt;</code></pre>
</div>
<p>add LA County to maps.</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">la_county</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">inat_lizard</span><span class="op">)</span> </span></code></pre>
</div>
<figure><img src="fig/6_creating_maps-rendered-unnamed-chunk-15-1.png" width="600" height="600" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mapview</span><span class="op">(</span><span class="va">la_county</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">mapview</span><span class="op">(</span><span class="va">inat_lizard</span><span class="op">)</span> </span></code></pre>
</div>
<figure><img src="fig/6_creating_maps-rendered-unnamed-chunk-16-1.png" width="600" height="600" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></section><section id="exploring-inaturlist-data"><h2 class="section-heading">Exploring iNaturlist data<a class="anchor" aria-label="anchor" href="#exploring-inaturlist-data"></a>
</h2>
<hr class="half-width">
<p>Lets look for all iNaturalist observations made in Exposition
Park.</p>
<p>I downloaded the boundaries for Exposition Park using this site <a href="https://wykhuh.github.io/draw-map-boundaries/" class="external-link uri">https://wykhuh.github.io/draw-map-boundaries/</a></p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">expo_park</span> <span class="op">&lt;-</span> <span class="fu">st_read</span><span class="op">(</span><span class="st">'data/raw/boundaries_expo_park_area.geojson'</span><span class="op">)</span>  <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">st_transform</span><span class="op">(</span><span class="fl">4326</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Reading layer `boundaries_expo_park_area' from data source 
  `/Users/wyk/Development/science/city_nature_challenge/NHMLA_workshop/CNC-coding-workshop/site/built/data/raw/boundaries_expo_park_area.geojson' 
  using driver `GeoJSON'
Simple feature collection with 1 feature and 2 fields
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: -118.2915 ymin: 34.01096 xmax: -118.2829 ymax: 34.01806
Geodetic CRS:  WGS 84</code></pre>
</div>
<p>plot map of Expo Park.</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">expo_park</span><span class="op">)</span> </span></code></pre>
</div>
<figure><img src="fig/6_creating_maps-rendered-unnamed-chunk-18-1.png" width="600" height="600" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mapview</span><span class="op">(</span><span class="va">expo_park</span><span class="op">)</span> </span></code></pre>
</div>
<figure><img src="fig/6_creating_maps-rendered-unnamed-chunk-19-1.png" width="600" height="600" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>We want to get observation inside Expo Park.</p>
<p>You should check if the crs for the inaturalist data and the Expo
Park are the same</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">st_crs</span><span class="op">(</span><span class="va">expo_park</span><span class="op">)</span> <span class="op">==</span> <span class="fu">st_crs</span><span class="op">(</span><span class="va">inat_map</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] TRUE</code></pre>
</div>
<p>Use <code>st_intersection()</code> to get all observations that
inside of Exposition Park.</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inat_expo</span> <span class="op">&lt;-</span> <span class="va">inat_map</span> <span class="op">%&gt;%</span> <span class="fu">st_intersection</span><span class="op">(</span><span class="va">expo_park</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: attribute variables are assumed to be spatially constant throughout
all geometries</code></pre>
</div>
<p>Use dim to get row and column count. 93K in LA county. 1191
observation in Expo Park.</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dim</span><span class="op">(</span><span class="va">inat_map</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 93948     9</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dim</span><span class="op">(</span><span class="va">inat_expo</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1191   11</code></pre>
</div>
<p>Create map of all observations in Expo Park.</p>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">expo_park</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">inat_expo</span><span class="op">)</span> </span></code></pre>
</div>
<figure><img src="fig/6_creating_maps-rendered-unnamed-chunk-23-1.png" width="600" height="600" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mapview</span><span class="op">(</span><span class="va">expo_park</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">mapview</span><span class="op">(</span><span class="va">inat_expo</span><span class="op">)</span> </span></code></pre>
</div>
<figure><img src="fig/6_creating_maps-rendered-unnamed-chunk-24-1.png" width="600" height="600" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Use alpha.regions to set opacity. use col.regions to set color.</p>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mapview</span><span class="op">(</span><span class="va">expo_park</span>,   alpha.regions<span class="op">=</span><span class="fl">0.3</span>, col.regions<span class="op">=</span><span class="st">"#333333"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">mapview</span><span class="op">(</span><span class="va">inat_expo</span><span class="op">)</span> </span></code></pre>
</div>
<figure><img src="fig/6_creating_maps-rendered-unnamed-chunk-25-1.png" width="600" height="600" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 --></section></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>
        
        <a href="https://github.com/wykhuh/CNC-coding-workshop/edit/main/README.md" class="external-link">Edit on GitHub</a>
        
	
        | <a href="https://github.com/wykhuh/CNC-coding-workshop/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/wykhuh/CNC-coding-workshop/" class="external-link">Source</a></p>
				<p><a href="https://github.com/wykhuh/CNC-coding-workshop/blob/main/CITATION.cff" class="external-link">Cite</a> | <a href="mailto:">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">
        
        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>
        
        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.4" class="external-link">sandpaper (0.16.4)</a>, <a href="https://github.com/carpentries/pegboard/tree/main" class="external-link">pegboard (0.7.5)</a>, and <a href="https://github.com/carpentries/varnish/tree/main" class="external-link">varnish (1.0.2)</a></p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://wykhuh.github.io/CNC-coding-workshop/aio.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://wykhuh.github.io/CNC-coding-workshop/aio.html",
  "identifier": "https://wykhuh.github.io/CNC-coding-workshop/aio.html",
  "dateCreated": "2024-05-22",
  "dateModified": "2024-05-24",
  "datePublished": "2024-05-24"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo
    2022-11-07: we have gotten a notification that we have an overage for our
    tracking and I'm pretty sure this has to do with Workbench usage.
    Considering that I am not _currently_ using this tracking because I do not
    yet know how to access the data, I am turning this off for now.
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setDomains", ["*.preview.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
    _paq.push(["setDoNotTrack", true]);
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
          var u="https://carpentries.matomo.cloud/";
          _paq.push(['setTrackerUrl', u+'matomo.php']);
          _paq.push(['setSiteId', '1']);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.async=true; g.src='https://cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
  </script>
  End Matomo Code -->
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

